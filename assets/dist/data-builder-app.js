var Zs=Object.defineProperty;var Qs=(s,r,t)=>r in s?Zs(s,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[r]=t;var hs=(s,r,t)=>Qs(s,typeof r!="symbol"?r+"":r,t);import{$ as et,r as E,o as je,q as Y,v as He,w as st,j as e,x as tt,y as _s,z as rt,u as Ae,A as at,B as it,c as Ee,C as Te,D as ce,E as nt,f as Le,a as lt,F as Fs,G as ks,J as ot,K as ct,L as dt,M as ut,N as mt,h as pt,k as ht,R as L,b as _,I as d,d as I,e as M,i as Q,t as xe,s as Oe,l as ze,O as ns,m as As,g as xt,P as xs,n as gt,H as ft}from"./middleware.js";import{u as ve,c as W,d as be,a as ye,b as we,m as ee,e as Ne,f as Pe,g as Ce,h as Re,i as Se}from"./index.js";import{u as jt,f as vt,i as ls,g as H,t as Be,a as q,c as Es,d as Ts,b as gs,e as bt,T as yt}from"./chunk-HO5AVL6Z.js";import"./features-animation.js";let Je=new Map,Ze=!1;try{Ze=new Intl.NumberFormat("de-DE",{signDisplay:"exceptZero"}).resolvedOptions().signDisplay==="exceptZero"}catch{}let Ie=!1;try{Ie=new Intl.NumberFormat("de-DE",{style:"unit",unit:"degree"}).resolvedOptions().style==="unit"}catch{}const Os={degree:{narrow:{default:"°","ja-JP":" 度","zh-TW":"度","sl-SI":" °"}}};class wt{format(r){let t="";if(!Ze&&this.options.signDisplay!=null?t=Pt(this.numberFormatter,this.options.signDisplay,r):t=this.numberFormatter.format(r),this.options.style==="unit"&&!Ie){var a;let{unit:i,unitDisplay:n="short",locale:l}=this.resolvedOptions();if(!i)return t;let o=(a=Os[i])===null||a===void 0?void 0:a[n];t+=o[l]||o.default}return t}formatToParts(r){return this.numberFormatter.formatToParts(r)}formatRange(r,t){if(typeof this.numberFormatter.formatRange=="function")return this.numberFormatter.formatRange(r,t);if(t<r)throw new RangeError("End date must be >= start date");return`${this.format(r)} – ${this.format(t)}`}formatRangeToParts(r,t){if(typeof this.numberFormatter.formatRangeToParts=="function")return this.numberFormatter.formatRangeToParts(r,t);if(t<r)throw new RangeError("End date must be >= start date");let a=this.numberFormatter.formatToParts(r),i=this.numberFormatter.formatToParts(t);return[...a.map(n=>({...n,source:"startRange"})),{type:"literal",value:" – ",source:"shared"},...i.map(n=>({...n,source:"endRange"}))]}resolvedOptions(){let r=this.numberFormatter.resolvedOptions();return!Ze&&this.options.signDisplay!=null&&(r={...r,signDisplay:this.options.signDisplay}),!Ie&&this.options.style==="unit"&&(r={...r,style:"unit",unit:this.options.unit,unitDisplay:this.options.unitDisplay}),r}constructor(r,t={}){this.numberFormatter=Nt(r,t),this.options=t}}function Nt(s,r={}){let{numberingSystem:t}=r;if(t&&s.includes("-nu-")&&(s.includes("-u-")||(s+="-u-"),s+=`-nu-${t}`),r.style==="unit"&&!Ie){var a;let{unit:l,unitDisplay:o="short"}=r;if(!l)throw new Error('unit option must be provided with style: "unit"');if(!(!((a=Os[l])===null||a===void 0)&&a[o]))throw new Error(`Unsupported unit ${l} with unitDisplay = ${o}`);r={...r,style:"decimal"}}let i=s+(r?Object.entries(r).sort((l,o)=>l[0]<o[0]?-1:1).join():"");if(Je.has(i))return Je.get(i);let n=new Intl.NumberFormat(s,r);return Je.set(i,n),n}function Pt(s,r,t){if(r==="auto")return s.format(t);if(r==="never")return s.format(Math.abs(t));{let a=!1;if(r==="always"?a=t>0||Object.is(t,0):r==="exceptZero"&&(Object.is(t,-0)||Object.is(t,0)?t=Math.abs(t):a=t>0),a){let i=s.format(-t),n=s.format(t),l=i.replace(n,"").replace(/\u200e|\u061C/,"");return[...l].length!==1&&console.warn("@react-aria/i18n polyfill for NumberFormat signDisplay: Unsupported case"),i.replace(n,"!!!").replace(l,"+").replace("!!!",n)}else return s.format(t)}}function Ct(s={}){let{locale:r}=et();return E.useMemo(()=>new wt(r,s),[r,s])}var fs=je({slots:{base:"flex flex-col gap-2 w-full",label:"",labelWrapper:"flex justify-between",value:"",track:"z-0 relative bg-default-300/50 overflow-hidden rtl:rotate-180",indicator:"h-full"},variants:{color:{default:{indicator:"bg-default-400"},primary:{indicator:"bg-primary"},secondary:{indicator:"bg-secondary"},success:{indicator:"bg-success"},warning:{indicator:"bg-warning"},danger:{indicator:"bg-danger"}},size:{sm:{label:"text-small",value:"text-small",track:"h-1"},md:{label:"text-medium",value:"text-medium",track:"h-3"},lg:{label:"text-large",value:"text-large",track:"h-5"}},radius:{none:{track:"rounded-none",indicator:"rounded-none"},sm:{track:"rounded-small",indicator:"rounded-small"},md:{track:"rounded-medium",indicator:"rounded-medium"},lg:{track:"rounded-large",indicator:"rounded-large"},full:{track:"rounded-full",indicator:"rounded-full"}},isStriped:{true:{indicator:"bg-stripe-gradient-default bg-stripe-size"}},isIndeterminate:{true:{indicator:["absolute","w-full","origin-left","animate-indeterminate-bar"]}},isDisabled:{true:{base:"opacity-disabled cursor-not-allowed"}},disableAnimation:{true:{},false:{indicator:"transition-transform !duration-500"}}},defaultVariants:{color:"primary",size:"md",radius:"full",isStriped:!1,isIndeterminate:!1,isDisabled:!1},compoundVariants:[{disableAnimation:!0,isIndeterminate:!1,class:{indicator:"!transition-none motion-reduce:transition-none"}},{color:"primary",isStriped:!0,class:{indicator:"bg-stripe-gradient-primary bg-stripe-size"}},{color:"secondary",isStriped:!0,class:{indicator:"bg-stripe-gradient-secondary bg-stripe-size"}},{color:"success",isStriped:!0,class:{indicator:"bg-stripe-gradient-success bg-stripe-size"}},{color:"warning",isStriped:!0,class:{indicator:"bg-stripe-gradient-warning bg-stripe-size"}},{color:"danger",isStriped:!0,class:{indicator:"bg-stripe-gradient-danger bg-stripe-size"}}]},{twMerge:!0});je({slots:{base:"flex flex-col justify-center gap-1 max-w-fit items-center",label:"",svgWrapper:"relative block",svg:"z-0 relative overflow-hidden",track:"h-full stroke-default-300/50",indicator:"h-full stroke-current",value:"absolute font-normal inset-0 flex items-center justify-center"},variants:{color:{default:{svg:"text-default-400"},primary:{svg:"text-primary"},secondary:{svg:"text-secondary"},success:{svg:"text-success"},warning:{svg:"text-warning"},danger:{svg:"text-danger"}},size:{sm:{svg:"w-8 h-8",label:"text-small",value:"text-[0.5rem]"},md:{svg:"w-10 h-10",label:"text-small",value:"text-[0.55rem]"},lg:{svg:"w-12 h-12",label:"text-medium",value:"text-[0.6rem]"}},isIndeterminate:{true:{svg:"animate-spinner-ease-spin"}},isDisabled:{true:{base:"opacity-disabled cursor-not-allowed"}},disableAnimation:{true:{},false:{indicator:"transition-all !duration-500"}}},defaultVariants:{color:"primary",size:"md",isDisabled:!1},compoundVariants:[{disableAnimation:!0,isIndeterminate:!1,class:{svg:"!transition-none motion-reduce:transition-none"}}]});var js=je({base:["px-2","py-1","h-fit","font-mono","font-normal","inline-block","whitespace-nowrap"],variants:{color:{default:Y.flat.default,primary:Y.flat.primary,secondary:Y.flat.secondary,success:Y.flat.success,warning:Y.flat.warning,danger:Y.flat.danger},size:{sm:"text-small",md:"text-medium",lg:"text-large"},radius:{none:"rounded-none",sm:"rounded-small",md:"rounded-medium",lg:"rounded-large",full:"rounded-full"}},defaultVariants:{color:"default",size:"sm",radius:"sm"}}),Rt=je({slots:{base:["flex","relative","justify-center","items-center","box-border","overflow-hidden","align-middle","text-white","z-0",...st],img:["flex","object-cover","w-full","h-full","transition-opacity","!duration-500","opacity-0","data-[loaded=true]:opacity-100"],fallback:[...He,"flex","items-center","justify-center"],name:[...He,"font-normal","text-center","text-inherit"],icon:[...He,"flex","items-center","justify-center","text-inherit","w-full","h-full"]},variants:{size:{sm:{base:"w-8 h-8 text-tiny"},md:{base:"w-10 h-10 text-tiny"},lg:{base:"w-14 h-14 text-small"}},color:{default:{base:Y.solid.default},primary:{base:Y.solid.primary},secondary:{base:Y.solid.secondary},success:{base:Y.solid.success},warning:{base:Y.solid.warning},danger:{base:Y.solid.danger}},radius:{none:{base:"rounded-none"},sm:{base:"rounded-small"},md:{base:"rounded-medium"},lg:{base:"rounded-large"},full:{base:"rounded-full"}},isBordered:{true:{base:"ring-2 ring-offset-2 ring-offset-background dark:ring-offset-background-dark"}},isDisabled:{true:{base:"opacity-disabled"}},isInGroup:{true:{base:["-ms-2 data-[hover=true]:-translate-x-3 rtl:data-[hover=true]:translate-x-3 transition-transform","data-[focus-visible=true]:-translate-x-3 rtl:data-[focus-visible=true]:translate-x-3"]}},isInGridGroup:{true:{base:"m-0 data-[hover=true]:translate-x-0"}},disableAnimation:{true:{base:"transition-none",img:"transition-none"},false:{}}},defaultVariants:{size:"md",color:"default",radius:"full"},compoundVariants:[{color:"default",isBordered:!0,class:{base:"ring-default"}},{color:"primary",isBordered:!0,class:{base:"ring-primary"}},{color:"secondary",isBordered:!0,class:{base:"ring-secondary"}},{color:"success",isBordered:!0,class:{base:"ring-success"}},{color:"warning",isBordered:!0,class:{base:"ring-warning"}},{color:"danger",isBordered:!0,class:{base:"ring-danger"}}]});je({slots:{base:"flex items-center justify-center h-auto w-max",count:"hover:-translate-x-0"},variants:{isGrid:{true:"inline-grid grid-cols-4 gap-3"}}});var St=()=>e.jsxs("svg",{"aria-hidden":"true",fill:"none",height:"80%",role:"presentation",viewBox:"0 0 24 24",width:"80%",children:[e.jsx("path",{d:"M12 2C9.38 2 7.25 4.13 7.25 6.75C7.25 9.32 9.26 11.4 11.88 11.49C11.96 11.48 12.04 11.48 12.1 11.49C12.12 11.49 12.13 11.49 12.15 11.49C12.16 11.49 12.16 11.49 12.17 11.49C14.73 11.4 16.74 9.32 16.75 6.75C16.75 4.13 14.62 2 12 2Z",fill:"currentColor"}),e.jsx("path",{d:"M17.0809 14.1489C14.2909 12.2889 9.74094 12.2889 6.93094 14.1489C5.66094 14.9989 4.96094 16.1489 4.96094 17.3789C4.96094 18.6089 5.66094 19.7489 6.92094 20.5889C8.32094 21.5289 10.1609 21.9989 12.0009 21.9989C13.8409 21.9989 15.6809 21.5289 17.0809 20.5889C18.3409 19.7389 19.0409 18.5989 19.0409 17.3589C19.0309 16.1289 18.3409 14.9889 17.0809 14.1489Z",fill:"currentColor"})]}),[mr,Dt]=tt({name:"AvatarGroupContext",strict:!1});function _t(s={}){var r,t,a,i,n,l,o,h;const x=_s(),u=Dt(),m=!!u,{as:p,ref:b,src:v,name:S,icon:C,classNames:F,fallback:z,alt:B=S||"avatar",imgRef:D,color:A=(r=u==null?void 0:u.color)!=null?r:"default",radius:f=(t=u==null?void 0:u.radius)!=null?t:"full",size:k=(a=u==null?void 0:u.size)!=null?a:"md",isBordered:w=(i=u==null?void 0:u.isBordered)!=null?i:!1,isDisabled:y=(n=u==null?void 0:u.isDisabled)!=null?n:!1,isFocusable:c=!1,getInitials:P=rt,ignoreFallback:T=!1,showFallback:G=!1,ImgComponent:j="img",imgProps:R,className:O,onError:N,disableAnimation:g,...$}=s,U=p||"span",te=Ae(b),re=Ae(D),{isFocusVisible:K,isFocused:ae,focusProps:ds}=at(),{isHovered:Hs,hoverProps:Js}=it({isDisabled:y}),_e=(l=g??(x==null?void 0:x.disableAnimation))!=null?l:!1,us=(h=typeof j=="object"&&((o=j==null?void 0:j.displayName)==null?void 0:o.includes("HeroUI")))!=null?h:!1,Fe=jt({src:v,onError:N,ignoreFallback:T,shouldBypassImageLoad:p!==void 0||j!=="img"&&!us})==="loaded",ms=!us,Ks=(!v||!Fe)&&G,he=E.useMemo(()=>{var ie;return Rt({color:A,radius:f,size:k,isBordered:w,isDisabled:y,isInGroup:m,disableAnimation:_e,isInGridGroup:(ie=u==null?void 0:u.isGrid)!=null?ie:!1})},[A,f,k,w,y,_e,m,u==null?void 0:u.isGrid]),ps=Ee(F==null?void 0:F.base,O),Ve=E.useMemo(()=>c||p==="button",[c,p]),Ys=E.useCallback((ie={})=>({ref:te,tabIndex:Ve?0:-1,"data-hover":ce(Hs),"data-focus":ce(ae),"data-focus-visible":ce(K),className:he.base({class:Ee(ps,ie==null?void 0:ie.className)}),...Te($,Js,Ve?ds:{})}),[Ve,he,ps,ds,$]),Xs=E.useCallback((ie={})=>({ref:re,src:v,"data-loaded":ce(Fe),className:he.img({class:F==null?void 0:F.img}),...Te(R,ie,nt({disableAnimation:_e},{enabled:ms}))}),[he,Fe,R,_e,v,re,ms]);return{Component:U,ImgComponent:j,src:v,alt:B,icon:C,name:S,imgRef:re,slots:he,classNames:F,fallback:z,isImgLoaded:Fe,showFallback:Ks,ignoreFallback:T,getInitials:P,getAvatarProps:Ys,getImageProps:Xs}}var zs=Le((s,r)=>{const{Component:t,ImgComponent:a,src:i,icon:n=e.jsx(St,{}),alt:l,classNames:o,slots:h,name:x,showFallback:u,fallback:m,getInitials:p,getAvatarProps:b,getImageProps:v}=_t({...s,ref:r}),S=E.useMemo(()=>!u&&i?null:m?e.jsx("div",{"aria-label":l,className:h.fallback({class:o==null?void 0:o.fallback}),role:"img",children:m}):x?e.jsx("span",{"aria-label":l,className:h.name({class:o==null?void 0:o.name}),role:"img",children:p(x)}):e.jsx("span",{"aria-label":l,className:h.icon({class:o==null?void 0:o.icon}),role:"img",children:n}),[u,i,m,x,o]);return e.jsxs(t,{...b(),children:[i&&e.jsx(a,{...v(),alt:l}),S]})});zs.displayName="HeroUI.Avatar";var ue=zs,Is=Le((s,r)=>{var t;const{as:a,className:i,children:n,...l}=s,o=a||"div",h=Ae(r),{slots:x,classNames:u}=lt(),m=Ee(u==null?void 0:u.header,i);return e.jsx(o,{ref:h,className:(t=x.header)==null?void 0:t.call(x,{class:m}),...l,children:n})});Is.displayName="HeroUI.CardHeader";var V=Is;function Ft(s){const[r,t]=Fs(s,js.variantKeys),{as:a,children:i,className:n,...l}=r,o=a||"code",h=E.useMemo(()=>js({...t,className:n}),[ks(t),n]);return{Component:o,children:i,getCodeProps:()=>({className:h,...l})}}var Gs=Le((s,r)=>{const{Component:t,children:a,getCodeProps:i}=Ft({...s});return e.jsx(t,{ref:r,...i(),children:a})});Gs.displayName="HeroUI.Code";var kt=Gs;function At(s){let{value:r=0,minValue:t=0,maxValue:a=100,valueLabel:i,isIndeterminate:n,formatOptions:l={style:"percent"}}=s,o=ot(s,{labelable:!0}),{labelProps:h,fieldProps:x}=ct({...s,labelElementType:"span"});r=ut(r,t,a);let u=(r-t)/(a-t),m=Ct(l);if(!n&&!i){let p=l.style==="percent"?u:r;i=m.format(p)}return{progressBarProps:dt(o,{...x,"aria-valuenow":n?void 0:r,"aria-valuemin":t,"aria-valuemax":a,"aria-valuetext":n?void 0:i,role:"progressbar"}),labelProps:h}}function Et(s){var r,t;const a=_s(),[i,n]=Fs(s,fs.variantKeys),{ref:l,as:o,id:h,className:x,classNames:u,label:m,valueLabel:p,value:b=0,minValue:v=0,maxValue:S=100,showValueLabel:C=!1,formatOptions:F={style:"percent"},...z}=i,B=o||"div",D=Ae(l),A=Ee(u==null?void 0:u.base,x),[,f]=vt({rerender:!0,delay:100}),k=s.isIndeterminate,w=(t=(r=s.disableAnimation)!=null?r:a==null?void 0:a.disableAnimation)!=null?t:!1,{progressBarProps:y,labelProps:c}=At({id:h,label:m,value:b,minValue:v,maxValue:S,valueLabel:p,formatOptions:F,isIndeterminate:k,"aria-labelledby":s["aria-labelledby"],"aria-label":s["aria-label"]}),P=E.useMemo(()=>fs({...n,disableAnimation:w}),[ks(n),w]),T=w?!0:f,G=E.useMemo(()=>k||!T?void 0:mt((b-v)/(S-v)*100),[T,k,b,v,S]),j=E.useCallback((O={})=>({ref:D,"data-indeterminate":ce(k),"data-disabled":ce(s.isDisabled),className:P.base({class:A}),...Te(y,z,O)}),[D,P,k,s.isDisabled,A,y,z]),R=E.useCallback((O={})=>({className:P.label({class:u==null?void 0:u.label}),...Te(c,O)}),[P,u,c]);return{Component:B,domRef:D,slots:P,classNames:u,label:m,percentage:G,showValueLabel:C,getProgressBarProps:j,getLabelProps:R}}var $s=Le((s,r)=>{const{Component:t,slots:a,classNames:i,label:n,percentage:l,showValueLabel:o,getProgressBarProps:h,getLabelProps:x}=Et({...s,ref:r}),u=h(),m=n||o;return e.jsxs(t,{...u,children:[m?e.jsxs("div",{className:a.labelWrapper({class:i==null?void 0:i.labelWrapper}),children:[n&&e.jsx("span",{...x(),children:n}),o&&e.jsx("span",{className:a.value({class:i==null?void 0:i.value}),children:u["aria-valuetext"]})]}):null,e.jsx("div",{className:a.track({class:i==null?void 0:i.track}),children:e.jsx("div",{className:a.indicator({class:i==null?void 0:i.indicator}),style:{transform:`translateX(-${100-(l||0)}%)`}})})]})});$s.displayName="HeroUI.Progress";var Ms=$s,Ls=Symbol.for("immer-nothing"),vs=Symbol.for("immer-draftable"),J=Symbol.for("immer-state");function Z(s,...r){throw new Error(`[Immer] minified error nr: ${s}. Full error at: https://bit.ly/3cXEKWf`)}var me=Object.getPrototypeOf;function pe(s){return!!s&&!!s[J]}function le(s){var r;return s?Bs(s)||Array.isArray(s)||!!s[vs]||!!((r=s.constructor)!=null&&r[vs])||De(s)||We(s):!1}var Tt=Object.prototype.constructor.toString();function Bs(s){if(!s||typeof s!="object")return!1;const r=me(s);if(r===null)return!0;const t=Object.hasOwnProperty.call(r,"constructor")&&r.constructor;return t===Object?!0:typeof t=="function"&&Function.toString.call(t)===Tt}function Ge(s,r){Ue(s)===0?Reflect.ownKeys(s).forEach(t=>{r(t,s[t],s)}):s.forEach((t,a)=>r(a,t,s))}function Ue(s){const r=s[J];return r?r.type_:Array.isArray(s)?1:De(s)?2:We(s)?3:0}function Qe(s,r){return Ue(s)===2?s.has(r):Object.prototype.hasOwnProperty.call(s,r)}function Us(s,r,t){const a=Ue(s);a===2?s.set(r,t):a===3?s.add(t):s[r]=t}function Ot(s,r){return s===r?s!==0||1/s===1/r:s!==s&&r!==r}function De(s){return s instanceof Map}function We(s){return s instanceof Set}function ne(s){return s.copy_||s.base_}function es(s,r){if(De(s))return new Map(s);if(We(s))return new Set(s);if(Array.isArray(s))return Array.prototype.slice.call(s);const t=Bs(s);if(r===!0||r==="class_only"&&!t){const a=Object.getOwnPropertyDescriptors(s);delete a[J];let i=Reflect.ownKeys(a);for(let n=0;n<i.length;n++){const l=i[n],o=a[l];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(a[l]={configurable:!0,writable:!0,enumerable:o.enumerable,value:s[l]})}return Object.create(me(s),a)}else{const a=me(s);if(a!==null&&t)return{...s};const i=Object.create(a);return Object.assign(i,s)}}function os(s,r=!1){return qe(s)||pe(s)||!le(s)||(Ue(s)>1&&Object.defineProperties(s,{set:{value:ke},add:{value:ke},clear:{value:ke},delete:{value:ke}}),Object.freeze(s),r&&Object.values(s).forEach(t=>os(t,!0))),s}function ke(){Z(2)}function qe(s){return Object.isFrozen(s)}var zt={};function oe(s){const r=zt[s];return r||Z(0,s),r}var ge;function Ws(){return ge}function It(s,r){return{drafts_:[],parent_:s,immer_:r,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function bs(s,r){r&&(oe("Patches"),s.patches_=[],s.inversePatches_=[],s.patchListener_=r)}function ss(s){ts(s),s.drafts_.forEach(Gt),s.drafts_=null}function ts(s){s===ge&&(ge=s.parent_)}function ys(s){return ge=It(ge,s)}function Gt(s){const r=s[J];r.type_===0||r.type_===1?r.revoke_():r.revoked_=!0}function ws(s,r){r.unfinalizedDrafts_=r.drafts_.length;const t=r.drafts_[0];return s!==void 0&&s!==t?(t[J].modified_&&(ss(r),Z(4)),le(s)&&(s=$e(r,s),r.parent_||Me(r,s)),r.patches_&&oe("Patches").generateReplacementPatches_(t[J].base_,s,r.patches_,r.inversePatches_)):s=$e(r,t,[]),ss(r),r.patches_&&r.patchListener_(r.patches_,r.inversePatches_),s!==Ls?s:void 0}function $e(s,r,t){if(qe(r))return r;const a=r[J];if(!a)return Ge(r,(i,n)=>Ns(s,a,r,i,n,t)),r;if(a.scope_!==s)return r;if(!a.modified_)return Me(s,a.base_,!0),a.base_;if(!a.finalized_){a.finalized_=!0,a.scope_.unfinalizedDrafts_--;const i=a.copy_;let n=i,l=!1;a.type_===3&&(n=new Set(i),i.clear(),l=!0),Ge(n,(o,h)=>Ns(s,a,i,o,h,t,l)),Me(s,i,!1),t&&s.patches_&&oe("Patches").generatePatches_(a,t,s.patches_,s.inversePatches_)}return a.copy_}function Ns(s,r,t,a,i,n,l){if(pe(i)){const o=n&&r&&r.type_!==3&&!Qe(r.assigned_,a)?n.concat(a):void 0,h=$e(s,i,o);if(Us(t,a,h),pe(h))s.canAutoFreeze_=!1;else return}else l&&t.add(i);if(le(i)&&!qe(i)){if(!s.immer_.autoFreeze_&&s.unfinalizedDrafts_<1)return;$e(s,i),(!r||!r.scope_.parent_)&&typeof a!="symbol"&&(De(t)?t.has(a):Object.prototype.propertyIsEnumerable.call(t,a))&&Me(s,i)}}function Me(s,r,t=!1){!s.parent_&&s.immer_.autoFreeze_&&s.canAutoFreeze_&&os(r,t)}function $t(s,r){const t=Array.isArray(s),a={type_:t?1:0,scope_:r?r.scope_:Ws(),modified_:!1,finalized_:!1,assigned_:{},parent_:r,base_:s,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=a,n=cs;t&&(i=[a],n=fe);const{revoke:l,proxy:o}=Proxy.revocable(i,n);return a.draft_=o,a.revoke_=l,o}var cs={get(s,r){if(r===J)return s;const t=ne(s);if(!Qe(t,r))return Mt(s,t,r);const a=t[r];return s.finalized_||!le(a)?a:a===Ke(s.base_,r)?(Ye(s),s.copy_[r]=as(a,s)):a},has(s,r){return r in ne(s)},ownKeys(s){return Reflect.ownKeys(ne(s))},set(s,r,t){const a=qs(ne(s),r);if(a!=null&&a.set)return a.set.call(s.draft_,t),!0;if(!s.modified_){const i=Ke(ne(s),r),n=i==null?void 0:i[J];if(n&&n.base_===t)return s.copy_[r]=t,s.assigned_[r]=!1,!0;if(Ot(t,i)&&(t!==void 0||Qe(s.base_,r)))return!0;Ye(s),rs(s)}return s.copy_[r]===t&&(t!==void 0||r in s.copy_)||Number.isNaN(t)&&Number.isNaN(s.copy_[r])||(s.copy_[r]=t,s.assigned_[r]=!0),!0},deleteProperty(s,r){return Ke(s.base_,r)!==void 0||r in s.base_?(s.assigned_[r]=!1,Ye(s),rs(s)):delete s.assigned_[r],s.copy_&&delete s.copy_[r],!0},getOwnPropertyDescriptor(s,r){const t=ne(s),a=Reflect.getOwnPropertyDescriptor(t,r);return a&&{writable:!0,configurable:s.type_!==1||r!=="length",enumerable:a.enumerable,value:t[r]}},defineProperty(){Z(11)},getPrototypeOf(s){return me(s.base_)},setPrototypeOf(){Z(12)}},fe={};Ge(cs,(s,r)=>{fe[s]=function(){return arguments[0]=arguments[0][0],r.apply(this,arguments)}});fe.deleteProperty=function(s,r){return fe.set.call(this,s,r,void 0)};fe.set=function(s,r,t){return cs.set.call(this,s[0],r,t,s[0])};function Ke(s,r){const t=s[J];return(t?ne(t):s)[r]}function Mt(s,r,t){var i;const a=qs(r,t);return a?"value"in a?a.value:(i=a.get)==null?void 0:i.call(s.draft_):void 0}function qs(s,r){if(!(r in s))return;let t=me(s);for(;t;){const a=Object.getOwnPropertyDescriptor(t,r);if(a)return a;t=me(t)}}function rs(s){s.modified_||(s.modified_=!0,s.parent_&&rs(s.parent_))}function Ye(s){s.copy_||(s.copy_=es(s.base_,s.scope_.immer_.useStrictShallowCopy_))}var Lt=class{constructor(s){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(r,t,a)=>{if(typeof r=="function"&&typeof t!="function"){const n=t;t=r;const l=this;return function(h=n,...x){return l.produce(h,u=>t.call(this,u,...x))}}typeof t!="function"&&Z(6),a!==void 0&&typeof a!="function"&&Z(7);let i;if(le(r)){const n=ys(this),l=as(r,void 0);let o=!0;try{i=t(l),o=!1}finally{o?ss(n):ts(n)}return bs(n,a),ws(i,n)}else if(!r||typeof r!="object"){if(i=t(r),i===void 0&&(i=r),i===Ls&&(i=void 0),this.autoFreeze_&&os(i,!0),a){const n=[],l=[];oe("Patches").generateReplacementPatches_(r,i,n,l),a(n,l)}return i}else Z(1,r)},this.produceWithPatches=(r,t)=>{if(typeof r=="function")return(l,...o)=>this.produceWithPatches(l,h=>r(h,...o));let a,i;return[this.produce(r,t,(l,o)=>{a=l,i=o}),a,i]},typeof(s==null?void 0:s.autoFreeze)=="boolean"&&this.setAutoFreeze(s.autoFreeze),typeof(s==null?void 0:s.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(s.useStrictShallowCopy)}createDraft(s){le(s)||Z(8),pe(s)&&(s=Bt(s));const r=ys(this),t=as(s,void 0);return t[J].isManual_=!0,ts(r),t}finishDraft(s,r){const t=s&&s[J];(!t||!t.isManual_)&&Z(9);const{scope_:a}=t;return bs(a,r),ws(void 0,a)}setAutoFreeze(s){this.autoFreeze_=s}setUseStrictShallowCopy(s){this.useStrictShallowCopy_=s}applyPatches(s,r){let t;for(t=r.length-1;t>=0;t--){const i=r[t];if(i.path.length===0&&i.op==="replace"){s=i.value;break}}t>-1&&(r=r.slice(t+1));const a=oe("Patches").applyPatches_;return pe(s)?a(s,r):this.produce(s,i=>a(i,r))}};function as(s,r){const t=De(s)?oe("MapSet").proxyMap_(s,r):We(s)?oe("MapSet").proxySet_(s,r):$t(s,r);return(r?r.scope_:Ws()).drafts_.push(t),t}function Bt(s){return pe(s)||Z(10,s),Vs(s)}function Vs(s){if(!le(s)||qe(s))return s;const r=s[J];let t;if(r){if(!r.modified_)return r.base_;r.finalized_=!0,t=es(s,r.scope_.immer_.useStrictShallowCopy_)}else t=es(s,!0);return Ge(t,(a,i)=>{Us(t,a,Vs(i))}),r&&(r.finalized_=!1),t}var Ut=new Lt,Wt=Ut.produce;const qt=s=>(r,t,a)=>(a.setState=(i,n,...l)=>{const o=typeof i=="function"?Wt(i):i;return r(o,n,...l)},s(a.setState,t,a)),Vt=qt,X=s=>s.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,""),Ps=s=>({Shelter:"lucide:home",Toilet:"lucide:bath",Bridge:"lucide:route",Access:"lucide:wheelchair",Seating:"lucide:armchair",Lighting:"lucide:lamp"})[s]||"lucide:box",Cs=s=>({Shelter:"Outdoor structures for shade and protection",Toilet:"Public and portable sanitation facilities",Bridge:"Pedestrian and light vehicle crossings",Access:"Ramps, stairs, and accessibility solutions",Seating:"Benches and outdoor furniture options",Lighting:"Outdoor and pathway lighting solutions"})[s]||"Product category",Rs=s=>({Peninsula:"Modern shelters with excellent weather protection for parks and urban settings",Whyalla:"Robust shelters designed for coastal and high-wind environments",Coastal:"Corrosion-resistant designs perfect for beachfront and marine locations",Urban:"Contemporary designs that blend with modern city landscapes",Heritage:"Traditional designs that complement historic and cultural settings",EcoSan:"Environmentally friendly composting toilet solutions with minimal water usage",Standard:"Reliable and cost-effective public toilet facilities",Accessible:"Fully compliant accessible toilet facilities with enhanced features",Premium:"High-end toilet facilities with superior finishes and amenities",Compact:"Space-saving designs for areas with limited footprint","Small Span":"Compact bridges for garden paths and small water crossings","Large Span":"Extended bridges for wider crossings and heavier loads",Pedestrian:"Dedicated walkways designed for high foot traffic areas",Decorative:"Ornamental bridges that serve as landscape features","Heavy Duty":"Reinforced bridges capable of supporting maintenance vehicles"})[s]||`${s} product range`,Ss=s=>{const r={Peninsula:["Modern","Weather-resistant","Versatile"],Whyalla:["Robust","Wind-resistant","Durable"],Coastal:["Corrosion-resistant","Salt-proof","UV-stable"],Urban:["Contemporary","Modular","Space-efficient"],Heritage:["Traditional","Ornate","Classic"],EcoSan:["Eco-friendly","Low-water","Composting"],Standard:["Cost-effective","Reliable","Low-maintenance"],Accessible:["ADA Compliant","Spacious","Universal"],Premium:["High-end","Enhanced features","Superior finishes"],Compact:["Space-saving","Efficient","Urban-friendly"],"Small Span":["Compact","Decorative","Easy-install"],"Large Span":["Extended","Reinforced","Heavy-load"],Pedestrian:["High-traffic","Safety-focused","Accessible"],Decorative:["Ornamental","Artistic","Feature piece"],"Heavy Duty":["Vehicle-rated","Industrial","Maximum strength"],default:["Quality","Durable","Customizable"]};return r[s]||r.default},Xe={id:1,stepperForm:{steps:[{step:1,title:"Select Product Group",categories:[]},{step:2,title:"Select Product Range",ranges:{}},{step:3,title:"Select Individual Product",products:{}},{step:4,title:"View Product Content",productDetails:{}},{step:5,title:"Configure Options",options:{}},{step:6,title:"Contact Information",fields:[{name:"fullName",label:"Full Name",type:"text",required:!0},{name:"email",label:"Email Address",type:"email",required:!0},{name:"phone",label:"Phone Number",type:"tel",required:!1},{name:"company",label:"Company/Organization",type:"text",required:!1},{name:"message",label:"Additional Notes",type:"textarea",required:!1}]}]}},se=pt()(ht(Vt((s,r)=>({productData:Xe,productGroups:[],productRanges:[],products:[],relationships:{groupToRanges:{},rangeToProducts:{}},isDirty:!1,isSaving:!1,isLoading:!1,lastSaved:null,error:null,initializeFromWindowData:()=>{const t=window.urbanaAdmin;if(!t){console.warn("No urbanaAdmin window data found");return}t.stepperFormData&&(console.log("Loading stepper form data:",t.stepperFormData),s(a=>{a.productData=t.stepperFormData})),t.stepperDataBuilder&&typeof t.stepperDataBuilder=="object"&&t.stepperDataBuilder.productGroups&&t.stepperDataBuilder.productGroups.length>0?(console.log("Loading existing data builder data:",t.stepperDataBuilder),s(a=>{a.productGroups=t.stepperDataBuilder.productGroups||[],a.productRanges=t.stepperDataBuilder.productRanges||[],a.products=t.stepperDataBuilder.products||[],a.relationships=t.stepperDataBuilder.relationships||{groupToRanges:{},rangeToProducts:{}},t.stepperDataBuilder.lastSaved&&(a.lastSaved=new Date(t.stepperDataBuilder.lastSaved)),a.isDirty=!1})):(console.log("No existing data builder data found, extracting from stepper form data"),t.stepperFormData&&r().initializeFromProductData(t.stepperFormData))},loadData:async t=>{var a;if(!t){r().initializeFromWindowData();return}s(i=>{i.isLoading=!0,i.error=null});try{const i=await fetch(`/wp-json/urbana/v1/data-builder/${t}`,{method:"GET",headers:{"X-WP-Nonce":((a=window.urbanaAdmin)==null?void 0:a.nonce)||""}});if(!i.ok)throw new Error(`Failed to load data: ${i.status} ${i.statusText}`);const n=await i.json();n.stepper_form_data&&s(l=>{l.productData=n.stepper_form_data}),n.stepper_data_builder&&typeof n.stepper_data_builder=="object"&&n.stepper_data_builder.productGroups&&n.stepper_data_builder.productGroups.length>0?(console.log("Loading existing API data builder data:",n.stepper_data_builder),s(l=>{l.productGroups=n.stepper_data_builder.productGroups||[],l.productRanges=n.stepper_data_builder.productRanges||[],l.products=n.stepper_data_builder.products||[],l.relationships=n.stepper_data_builder.relationships||{groupToRanges:{},rangeToProducts:{}},n.stepper_data_builder.lastSaved&&(l.lastSaved=new Date(n.stepper_data_builder.lastSaved))})):(console.log("No existing API data builder data found, extracting from stepper form data"),n.stepper_form_data&&r().initializeFromProductData(n.stepper_form_data))}catch(i){const n=i instanceof Error?i.message:"Unknown error occurred";throw console.error("Error loading data:",n),s(l=>{l.error=n}),i}finally{s(i=>{i.isLoading=!1})}},getRangesForGroup:t=>{const{productRanges:a,relationships:i}=r(),n=i.groupToRanges[t]||[];return a.filter(l=>n.includes(l.id))},getProductsForRange:t=>{const{products:a,relationships:i}=r(),n=i.rangeToProducts[t]||[];return a.filter(l=>n.includes(l.id))},getProductById:t=>{const{products:a}=r();return a.find(i=>i.id===t)},getGroupById:t=>{const{productGroups:a}=r();return a.find(i=>i.id===t)},getRangeById:t=>{const{productRanges:a}=r();return a.find(i=>i.id===t)},saveData:async()=>{var t;s(a=>{a.isSaving=!0,a.error=null});try{const a=r().exportData(),{productGroups:i,productRanges:n,products:l,relationships:o}=r(),h=await fetch("/wp-json/urbana/v1/product-data",{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":((t=window.urbanaAdmin)==null?void 0:t.nonce)||""},body:JSON.stringify({stepper_form_data:a,stepper_data_builder:{productGroups:i,productRanges:n,products:l,relationships:o,lastSaved:new Date().toISOString()}})});if(!h.ok)throw new Error(`Failed to save data: ${h.status} ${h.statusText}`);const x=await h.json();return s(u=>{u.productData=a,u.isDirty=!1,u.lastSaved=new Date}),console.log("Data saved successfully, stepper ID:",x.stepper_id),x.stepper_id}catch(a){const i=a instanceof Error?a.message:"Unknown error occurred";throw console.error("Error saving data:",i),s(n=>{n.error=i}),a}finally{s(a=>{a.isSaving=!1})}},initializeFromProductData:t=>s(a=>{a.productData=t;const i=(t.stepperForm.steps[0].categories||[]).map(x=>({id:X(x),name:x,icon:Ps(x),description:Cs(x)}));a.productGroups=i;const n=[];Object.entries(t.stepperForm.steps[1].ranges||{}).forEach(([x,u])=>{u.forEach(m=>{n.push({id:X(m),name:m,image:"",description:Rs(m),tags:Ss(m)})})}),a.productRanges=n;const l=[];Object.entries(t.stepperForm.steps[2].products||{}).forEach(([x,u])=>{u.forEach(m=>{var b;const p=(b=t.stepperForm.steps[3].productDetails)==null?void 0:b[m];l.push({id:X(m),code:m,name:(p==null?void 0:p.name)||`${m} Product`,overview:(p==null?void 0:p.overview)||"",description:(p==null?void 0:p.description)||"",specifications:(p==null?void 0:p.specifications)||[],imageGallery:(p==null?void 0:p.imageGallery)||[],files:(p==null?void 0:p.files)||{}})})}),a.products=l;const o={};Object.entries(t.stepperForm.steps[1].ranges||{}).forEach(([x,u])=>{const m=X(x);o[m]=u.map(p=>X(p))});const h={};Object.entries(t.stepperForm.steps[2].products||{}).forEach(([x,u])=>{const m=X(x);h[m]=u.map(p=>X(p))}),a.relationships={groupToRanges:o,rangeToProducts:h}}),updateProductData:t=>s(a=>{a.productData=t,a.isDirty=!0}),exportData:()=>{const{productGroups:t,productRanges:a,products:i,relationships:n,productData:l}=r();return{id:l.id,stepperForm:{steps:[{step:1,title:"Select Product Group",categories:t.map(h=>h.name)},{step:2,title:"Select Product Range",ranges:(()=>{const h={};return Object.entries(n.groupToRanges).forEach(([x,u])=>{const m=t.find(p=>p.id===x);m&&(h[m.name]=u.map(p=>{const b=a.find(v=>v.id===p);return b?b.name:""}).filter(p=>p!==""))}),h})()},{step:3,title:"Select Individual Product",products:(()=>{const h={};return Object.entries(n.rangeToProducts).forEach(([x,u])=>{const m=a.find(p=>p.id===x);m&&(h[m.name]=u.map(p=>{const b=i.find(v=>v.id===p);return b?b.code:""}).filter(p=>p!==""))}),h})()},{step:4,title:"View Product Content",productDetails:(()=>{const h={};return i.forEach(x=>{h[x.code]={name:x.name,overview:x.overview,description:x.description,specifications:x.specifications,imageGallery:x.imageGallery,files:x.files}}),h})()},l.stepperForm.steps[4]||{step:5,title:"Configure Options",options:{}},l.stepperForm.steps[5]||{step:6,title:"Contact Information",fields:Xe.stepperForm.steps[5].fields}]}}},addProductGroup:t=>s(a=>{const i=X(t.name),n={...t,id:i,icon:t.icon||Ps(t.name),description:t.description||Cs(t.name)};a.productGroups.some(o=>o.id===i)||(a.productGroups.push(n),a.relationships.groupToRanges[i]=[],a.isDirty=!0)}),updateProductGroup:(t,a)=>s(i=>{const n=i.productGroups.findIndex(l=>l.id===t);n!==-1&&(i.productGroups[n]={...i.productGroups[n],...a},i.isDirty=!0)}),removeProductGroup:t=>s(a=>{a.productGroups=a.productGroups.filter(n=>n.id!==t),(a.relationships.groupToRanges[t]||[]).forEach(n=>{a.productRanges=a.productRanges.filter(o=>o.id!==n),(a.relationships.rangeToProducts[n]||[]).forEach(o=>{a.products=a.products.filter(h=>h.id!==o)}),delete a.relationships.rangeToProducts[n]}),delete a.relationships.groupToRanges[t],a.isDirty=!0}),addProductRange:t=>s(a=>{const i=X(t.name),n={...t,id:i,description:t.description||Rs(t.name),tags:t.tags||Ss(t.name)};a.productRanges.some(o=>o.id===i)||(a.productRanges.push(n),a.relationships.rangeToProducts[i]=[],a.isDirty=!0)}),updateProductRange:(t,a)=>s(i=>{const n=i.productRanges.findIndex(l=>l.id===t);n!==-1&&(i.productRanges[n]={...i.productRanges[n],...a},i.isDirty=!0)}),removeProductRange:t=>s(a=>{a.productRanges=a.productRanges.filter(n=>n.id!==t),(a.relationships.rangeToProducts[t]||[]).forEach(n=>{a.products=a.products.filter(l=>l.id!==n)}),Object.keys(a.relationships.groupToRanges).forEach(n=>{a.relationships.groupToRanges[n]=a.relationships.groupToRanges[n].filter(l=>l!==t)}),delete a.relationships.rangeToProducts[t],a.isDirty=!0}),addProduct:t=>s(a=>{const i=X(t.code||t.name),n={...t,id:i,code:t.code||X(t.name)};a.products.some(o=>o.id===i)||(a.products.push(n),a.isDirty=!0)}),updateProduct:(t,a)=>s(i=>{const n=i.products.findIndex(l=>l.id===t);n!==-1&&(i.products[n]={...i.products[n],...a},i.isDirty=!0)}),removeProduct:t=>s(a=>{a.products=a.products.filter(i=>i.id!==t),Object.keys(a.relationships.rangeToProducts).forEach(i=>{a.relationships.rangeToProducts[i]=a.relationships.rangeToProducts[i].filter(n=>n!==t)}),a.isDirty=!0}),linkRangeToGroup:(t,a)=>s(i=>{i.relationships.groupToRanges[t]||(i.relationships.groupToRanges[t]=[]),i.relationships.groupToRanges[t].includes(a)||(i.relationships.groupToRanges[t].push(a),i.isDirty=!0)}),unlinkRangeFromGroup:(t,a)=>s(i=>{i.relationships.groupToRanges[t]&&(i.relationships.groupToRanges[t]=i.relationships.groupToRanges[t].filter(n=>n!==a),i.isDirty=!0)}),linkProductToRange:(t,a)=>s(i=>{i.relationships.rangeToProducts[t]||(i.relationships.rangeToProducts[t]=[]),i.relationships.rangeToProducts[t].includes(a)||(i.relationships.rangeToProducts[t].push(a),i.isDirty=!0)}),unlinkProductFromRange:(t,a)=>s(i=>{i.relationships.rangeToProducts[t]&&(i.relationships.rangeToProducts[t]=i.relationships.rangeToProducts[t].filter(n=>n!==a),i.isDirty=!0)}),updateRelationships:t=>s(a=>{a.relationships=t,a.isDirty=!0}),updateOptions:t=>s(a=>{a.productData.stepperForm.steps[4]&&(a.productData.stepperForm.steps[4].options=t,a.isDirty=!0)}),updateContactFields:t=>s(a=>{a.productData.stepperForm.steps[5]&&(a.productData.stepperForm.steps[5].fields=t,a.isDirty=!0)}),resetData:()=>s(t=>{t.productData=Xe,t.productGroups=[],t.productRanges=[],t.products=[],t.relationships={groupToRanges:{},rangeToProducts:{}},t.isDirty=!1,t.lastSaved=null,t.error=null}),importData:t=>s(a=>{a.isDirty=!0,a.lastSaved=null,a.error=null,r().initializeFromProductData(t)}),setError:t=>s(a=>{a.error=t}),clearError:()=>s(t=>{t.error=null})})),{name:"urbana-data-builder"})),Ht=({selectedIcon:s,onIconSelect:r})=>{const t=["lucide:box","lucide:home","lucide:bath","lucide:route","lucide:wheelchair","lucide:armchair","lucide:lamp","lucide:tree","lucide:building","lucide:car","lucide:tools","lucide:shield"];return e.jsx("div",{className:"grid grid-cols-6 gap-2",children:t.map(a=>e.jsx(_,{isIconOnly:!0,variant:s===a?"solid":"bordered",color:s===a?"primary":"default",onPress:()=>r(a),className:"h-12 w-12",children:e.jsx(d,{icon:a,width:20})},a))})},Jt=()=>{const{productGroups:s,addProductGroup:r,updateProductGroup:t,removeProductGroup:a,getRangesForGroup:i}=se(),{isOpen:n,onOpen:l,onOpenChange:o,onClose:h}=ve(),[x,u]=L.useState(null),[m,p]=L.useState({name:"",icon:"lucide:box",description:""}),[b,v]=L.useState({}),S=()=>{u(null),p({name:"",icon:"lucide:box",description:""}),v({}),l()},C=f=>{u(f),p({name:f.name,icon:f.icon,description:f.description}),v({}),l()},F=f=>{const k=i(f).length,w=k>0?`Are you sure you want to delete this product group? This will also remove ${k} associated range(s) and their products.`:"Are you sure you want to delete this product group?";confirm(w)&&a(f)},z=(f,k)=>{p(w=>({...w,[f]:k})),b[f]&&v(w=>({...w,[f]:""}))},B=f=>{p(k=>({...k,icon:f}))},D=()=>{const f={};return m.name.trim()||(f.name="Name is required"),s.some(w=>w.name.toLowerCase()===m.name.toLowerCase()&&(!x||w.id!==x.id))&&(f.name="A product group with this name already exists"),m.description.trim()||(f.description="Description is required"),v(f),Object.keys(f).length===0},A=()=>{D()&&(x?t(x.id,m):r(m),h())};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Product Groups"}),e.jsx("p",{className:"text-sm text-foreground-500",children:"Organize your products into logical categories"})]}),e.jsx(_,{color:"primary",onPress:S,startContent:e.jsx(d,{icon:"lucide:plus",width:18}),children:"Add Product Group"})]}),s.length===0?e.jsx(I,{children:e.jsx(M,{className:"text-center py-12",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx(d,{icon:"lucide:layers",width:48,className:"text-foreground-300"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground-600",children:"No Product Groups Yet"}),e.jsx("p",{className:"text-sm text-foreground-500",children:"Create your first product group to get started"})]}),e.jsx(_,{color:"primary",onPress:S,startContent:e.jsx(d,{icon:"lucide:plus",width:18}),children:"Add Product Group"})]})})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:s.map(f=>{const k=i(f.id).length;return e.jsxs(I,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(V,{className:"pb-3",children:e.jsxs("div",{className:"flex justify-between items-start w-full",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ue,{icon:e.jsx(d,{icon:f.icon,width:20}),className:"bg-primary-100 text-primary-800",size:"sm"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold",children:f.name}),e.jsxs(W,{size:"sm",variant:"flat",color:"primary",children:[k," range",k!==1?"s":""]})]})]}),e.jsxs(be,{children:[e.jsx(ye,{children:e.jsx(_,{isIconOnly:!0,variant:"light",size:"sm",children:e.jsx(d,{icon:"lucide:more-vertical",width:16})})}),e.jsxs(we,{"aria-label":"Group Actions",children:[e.jsx(ee,{startContent:e.jsx(d,{icon:"lucide:edit",width:16}),onPress:()=>C(f),children:"Edit"},"edit"),e.jsx(ee,{className:"text-danger",color:"danger",startContent:e.jsx(d,{icon:"lucide:trash",width:16}),onPress:()=>F(f.id),children:"Delete"},"delete")]})]})]})}),e.jsx(M,{className:"pt-0",children:e.jsx("p",{className:"text-sm text-foreground-600",children:f.description})})]},f.id)})}),e.jsx(Ne,{isOpen:n,onOpenChange:o,size:"lg",className:"urbana-modal",children:e.jsx(Pe,{children:f=>e.jsxs(e.Fragment,{children:[e.jsx(Ce,{children:x?"Edit Product Group":"Add Product Group"}),e.jsx(Re,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(Q,{label:"Name",placeholder:"Enter group name",value:m.name,onChange:k=>z("name",k.target.value),errorMessage:b.name,isInvalid:!!b.name,isRequired:!0,classNames:{input:"urbana-input"}}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-foreground-700 mb-2 block",children:"Icon"}),e.jsx(Ht,{selectedIcon:m.icon,onIconSelect:B})]}),e.jsx(xe,{label:"Description",placeholder:"Enter group description",value:m.description,onChange:k=>z("description",k.target.value),errorMessage:b.description,isInvalid:!!b.description,isRequired:!0,rows:3,classNames:{input:"urbana-input"}})]})}),e.jsxs(Se,{children:[e.jsx(_,{variant:"light",onPress:f,children:"Cancel"}),e.jsxs(_,{color:"primary",onPress:A,children:[x?"Update":"Add"," Group"]})]})]})})})]})},Kt=({tags:s,onTagsChange:r})=>{const[t,a]=L.useState(""),i=l=>{if(l.key==="Enter"&&t.trim()){l.preventDefault();const o=t.trim();s.includes(o)||r([...s,o]),a("")}},n=l=>{r(s.filter(o=>o!==l))};return e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{placeholder:"Type a tag and press Enter",value:t,onChange:l=>a(l.target.value),onKeyDown:i,classNames:{input:"urbana-input"}}),s.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:s.map(l=>e.jsx(W,{onClose:()=>n(l),variant:"flat",size:"sm",children:l},l))})]})},Yt=()=>{const{productRanges:s,productGroups:r,addProductRange:t,updateProductRange:a,removeProductRange:i,getProductsForRange:n,linkRangeToGroup:l,unlinkRangeFromGroup:o,relationships:h}=se(),{isOpen:x,onOpen:u,onOpenChange:m,onClose:p}=ve(),[b,v]=L.useState(null),[S,C]=L.useState({name:"",image:"",description:"",tags:[]}),[F,z]=L.useState(new Set),[B,D]=L.useState({}),A=()=>{v(null),C({name:"",image:"",description:"",tags:[]}),z(new Set),D({}),u()},f=j=>{v(j),C({name:j.name,image:j.image,description:j.description,tags:[...j.tags]});const R=new Set;Object.entries(h.groupToRanges).forEach(([O,N])=>{N.includes(j.id)&&R.add(O)}),z(R),D({}),u()},k=j=>{const R=n(j).length,O=R>0?`Are you sure you want to delete this product range? This will also remove ${R} associated product(s).`:"Are you sure you want to delete this product range?";confirm(O)&&i(j)},w=(j,R)=>{C(O=>({...O,[j]:R})),B[j]&&D(O=>({...O,[j]:""}))},y=()=>{const j={};return S.name.trim()||(j.name="Name is required"),s.some(O=>O.name.toLowerCase()===S.name.toLowerCase()&&(!b||O.id!==b.id))&&(j.name="A product range with this name already exists"),S.description.trim()||(j.description="Description is required"),F.size===0&&(j.groups="Please select at least one product group"),D(j),Object.keys(j).length===0},c=()=>{if(!y())return;let j;b?(a(b.id,S),j=b.id,Object.keys(h.groupToRanges).forEach(R=>{o(R,b.id)})):(t(S),j=S.name.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,"")),F.forEach(R=>{l(R,j)}),p()},P=()=>{const j={},R=[];return s.forEach(O=>{let N=!1;Object.entries(h.groupToRanges).forEach(([g,$])=>{if($.includes(O.id)){const U=r.find(te=>te.id===g);U&&(j[U.name]||(j[U.name]=[]),j[U.name].push(O),N=!0)}}),N||R.push(O)}),{grouped:j,ungrouped:R}},{grouped:T,ungrouped:G}=P();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Product Ranges"}),e.jsx("p",{className:"text-sm text-foreground-500",children:"Define specific product lines within each group"})]}),e.jsx(_,{color:"primary",onPress:A,startContent:e.jsx(d,{icon:"lucide:plus",width:18}),isDisabled:r.length===0,children:"Add Product Range"})]}),r.length===0?e.jsx(I,{children:e.jsx(M,{className:"text-center py-12",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx(d,{icon:"lucide:alert-circle",width:48,className:"text-warning-500"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground-600",children:"No Product Groups Available"}),e.jsx("p",{className:"text-sm text-foreground-500",children:"You need to create product groups first before adding ranges"})]})]})})}):s.length===0?e.jsx(I,{children:e.jsx(M,{className:"text-center py-12",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx(d,{icon:"lucide:grid-3x3",width:48,className:"text-foreground-300"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground-600",children:"No Product Ranges Yet"}),e.jsx("p",{className:"text-sm text-foreground-500",children:"Create your first product range to organize your products"})]}),e.jsx(_,{color:"primary",onPress:A,startContent:e.jsx(d,{icon:"lucide:plus",width:18}),children:"Add Product Range"})]})})}):e.jsxs("div",{className:"space-y-6",children:[Object.entries(T).map(([j,R])=>e.jsxs("div",{children:[e.jsxs("h4",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:[e.jsx(d,{icon:"lucide:layers",width:18}),j,e.jsxs(W,{size:"sm",variant:"flat",children:[R.length," range",R.length!==1?"s":""]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:R.map(O=>e.jsx(Ds,{range:O,onEdit:f,onDelete:k},O.id))})]},j)),G.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-lg font-semibold mb-3 flex items-center gap-2 text-warning-600",children:[e.jsx(d,{icon:"lucide:alert-triangle",width:18}),"Ungrouped Ranges",e.jsxs(W,{size:"sm",variant:"flat",color:"warning",children:[G.length," range",G.length!==1?"s":""]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:G.map(j=>e.jsx(Ds,{range:j,onEdit:f,onDelete:k},j.id))})]})]}),e.jsx(Ne,{isOpen:x,onOpenChange:m,size:"2xl",className:"urbana-modal",children:e.jsx(Pe,{children:j=>e.jsxs(e.Fragment,{children:[e.jsx(Ce,{children:b?"Edit Product Range":"Add Product Range"}),e.jsx(Re,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(Q,{label:"Name",placeholder:"Enter range name",value:S.name,onChange:R=>w("name",R.target.value),errorMessage:B.name,isInvalid:!!B.name,isRequired:!0,classNames:{input:"urbana-input"}}),e.jsx(Oe,{label:"Product Groups",placeholder:"Select product groups for this range",selectionMode:"multiple",selectedKeys:F,onSelectionChange:R=>z(R),errorMessage:B.groups,isInvalid:!!B.groups,isRequired:!0,children:r.map(R=>e.jsx(ze,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{icon:R.icon,width:16}),R.name]})},R.id))}),e.jsx(Q,{label:"Image URL",placeholder:"Enter image URL (optional)",value:S.image,onChange:R=>w("image",R.target.value),classNames:{input:"urbana-input"}}),e.jsx(xe,{label:"Description",placeholder:"Enter range description",value:S.description,onChange:R=>w("description",R.target.value),errorMessage:B.description,isInvalid:!!B.description,isRequired:!0,rows:3,classNames:{input:"urbana-input"}}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-foreground-700 mb-2 block",children:"Tags"}),e.jsx(Kt,{tags:S.tags,onTagsChange:R=>w("tags",R)})]})]})}),e.jsxs(Se,{children:[e.jsx(_,{variant:"light",onPress:j,children:"Cancel"}),e.jsxs(_,{color:"primary",onPress:c,children:[b?"Update":"Add"," Range"]})]})]})})})]})},Ds=({range:s,onEdit:r,onDelete:t})=>{const{getProductsForRange:a}=se(),i=a(s.id).length;return e.jsxs(I,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(V,{className:"pb-3",children:e.jsxs("div",{className:"flex justify-between items-start w-full",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[s.image?e.jsx(ls,{src:s.image,alt:s.name,width:40,height:40,className:"rounded-lg object-cover"}):e.jsx("div",{className:"w-10 h-10 bg-secondary-100 rounded-lg flex items-center justify-center",children:e.jsx(d,{icon:"lucide:grid-3x3",width:20,className:"text-secondary-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold",children:s.name}),e.jsxs(W,{size:"sm",variant:"flat",color:"secondary",children:[i," product",i!==1?"s":""]})]})]}),e.jsxs(be,{children:[e.jsx(ye,{children:e.jsx(_,{isIconOnly:!0,variant:"light",size:"sm",children:e.jsx(d,{icon:"lucide:more-vertical",width:16})})}),e.jsxs(we,{"aria-label":"Range Actions",children:[e.jsx(ee,{startContent:e.jsx(d,{icon:"lucide:edit",width:16}),onPress:()=>r(s),children:"Edit"},"edit"),e.jsx(ee,{className:"text-danger",color:"danger",startContent:e.jsx(d,{icon:"lucide:trash",width:16}),onPress:()=>t(s.id),children:"Delete"},"delete")]})]})]})}),e.jsxs(M,{className:"pt-0",children:[e.jsx("p",{className:"text-sm text-foreground-600 mb-2",children:s.description}),s.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1",children:s.tags.map(n=>e.jsx(W,{size:"sm",variant:"flat",color:"default",children:n},n))})]})]})},Xt=({files:s,onFilesChange:r,productCode:t,category:a,range:i})=>{const[n,l]=L.useState(""),[o,h]=L.useState(""),x=E.useCallback(()=>{n.trim()&&o.trim()&&(r({...s,[n.trim()]:o.trim()}),l(""),h(""))},[n,o,s,r]),u=E.useCallback(v=>{const S={...s};delete S[v],r(S)},[s,r]),m=E.useCallback(()=>{var S;if(!((S=window.wp)!=null&&S.media)){console.error("WordPress media library not available");return}const v=window.wp.media({title:"Select Files",button:{text:"Add to Product"},multiple:!0});v.on("select",()=>{const C=v.state().get("selection").toJSON(),F={...s};C.forEach(z=>{const B=z.filename||z.title;F[B]=z.url}),r(F)}),v.open()},[s,r]),p=E.useCallback(async()=>{var S;if(!t||!a||!i){console.error("Missing product information for folder fetch");return}if(confirm("This will fetch files from the plugin folder and update the current file list. Continue?"))try{const C=await fetch("/wp-json/urbana/v1/fetch-product-files",{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":((S=window.urbanaAdmin)==null?void 0:S.nonce)||""},body:JSON.stringify({productCode:t.toLowerCase(),category:a.toLowerCase(),range:i.toLowerCase().replace(/\s+/g,"-")})});if(!C.ok)throw new Error(`Failed to fetch files: ${C.status}`);const F=await C.json();F.success&&F.files?r(F.files):console.warn("No files found in folder or fetch failed")}catch(C){console.error("Error fetching files from folder:",C)}},[t,a,i,r]),b=v=>{var C;switch((C=v.split(".").pop())==null?void 0:C.toLowerCase()){case"pdf":return"lucide:file-text";case"dwg":case"dxf":return"lucide:compass";case"rvt":return"lucide:building";case"doc":case"docx":return"lucide:file-type";case"xls":case"xlsx":return"lucide:sheet";default:return"lucide:file"}};return e.jsxs(I,{children:[e.jsx(V,{className:"pb-3",children:e.jsxs("div",{className:"flex justify-between items-center w-full",children:[e.jsx("h4",{className:"text-md font-semibold",children:"Product Files"}),e.jsxs("div",{className:"flex gap-2",children:[t&&e.jsx(_,{size:"sm",color:"secondary",variant:"flat",onPress:p,startContent:e.jsx(d,{icon:"lucide:folder-sync",width:16}),children:"Fetch from Folder"}),e.jsx(_,{size:"sm",color:"primary",variant:"flat",onPress:m,startContent:e.jsx(d,{icon:"lucide:library",width:16}),children:"Media Library"})]})]})}),e.jsxs(M,{className:"space-y-4",children:[e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Q,{placeholder:"File name",value:n,onChange:v=>l(v.target.value),size:"sm",classNames:{input:"urbana-input"}}),e.jsx(Q,{placeholder:"File URL or path",value:o,onChange:v=>h(v.target.value),size:"sm",classNames:{input:"urbana-input"}}),e.jsx(_,{size:"sm",color:"primary",onPress:x,isDisabled:!n.trim()||!o.trim(),children:"Add"})]})}),Object.entries(s).length>0&&e.jsxs(e.Fragment,{children:[e.jsx(ns,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("span",{className:"text-sm font-medium",children:["Files (",Object.entries(s).length,")"]})}),Object.entries(s).map(([v,S])=>e.jsxs("div",{className:"flex justify-between items-center p-3 bg-default-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(d,{icon:b(S),width:20,className:"text-primary-500"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("span",{className:"font-medium text-sm",children:v}),e.jsx("p",{className:"text-xs text-foreground-500 truncate",children:S})]})]}),e.jsxs(be,{children:[e.jsx(ye,{children:e.jsx(_,{isIconOnly:!0,size:"sm",variant:"light",children:e.jsx(d,{icon:"lucide:more-vertical",width:16})})}),e.jsxs(we,{children:[e.jsx(ee,{startContent:e.jsx(d,{icon:"lucide:external-link",width:16}),onPress:()=>window.open(S,"_blank"),children:"View File"},"view"),e.jsx(ee,{className:"text-danger",color:"danger",startContent:e.jsx(d,{icon:"lucide:trash",width:16}),onPress:()=>u(v),children:"Remove"},"remove")]})]})]},v))]})]})]})]})},Zt=({imageGallery:s,onImageGalleryChange:r,productCode:t,category:a,range:i})=>{const n=E.useCallback((u,m)=>{const p=[...s];p[u]=m,r(p)},[s,r]),l=E.useCallback(u=>{const m=s.filter((p,b)=>b!==u);r(m)},[s,r]),o=E.useCallback(()=>{r([...s,""])},[s,r]),h=E.useCallback(()=>{var m;if(!((m=window.wp)!=null&&m.media)){console.error("WordPress media library not available");return}const u=window.wp.media({title:"Select Images",button:{text:"Add to Gallery"},multiple:!0,library:{type:"image"}});u.on("select",()=>{const b=u.state().get("selection").toJSON().map(v=>v.url);r([...s,...b])}),u.open()},[s,r]),x=E.useCallback(async()=>{var m;if(!t||!a||!i){console.error("Missing product information for folder fetch");return}if(confirm("This will fetch images from the plugin folder and update the current gallery. Continue?"))try{const p=await fetch("/wp-json/urbana/v1/fetch-product-images",{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":((m=window.urbanaAdmin)==null?void 0:m.nonce)||""},body:JSON.stringify({productCode:t.toLowerCase(),category:a.toLowerCase(),range:i.toLowerCase().replace(/\s+/g,"-")})});if(!p.ok)throw new Error(`Failed to fetch images: ${p.status}`);const b=await p.json();b.success&&b.images?r(b.images):console.warn("No images found in folder or fetch failed")}catch(p){console.error("Error fetching images from folder:",p)}},[t,a,i,r]);return e.jsxs(I,{children:[e.jsx(V,{className:"pb-3",children:e.jsxs("div",{className:"flex justify-between items-center w-full",children:[e.jsx("h4",{className:"text-md font-semibold",children:"Image Gallery"}),e.jsxs("div",{className:"flex gap-2",children:[t&&e.jsx(_,{size:"sm",color:"secondary",variant:"flat",onPress:x,startContent:e.jsx(d,{icon:"lucide:image-plus",width:16}),children:"Fetch from Folder"}),e.jsx(_,{size:"sm",color:"primary",variant:"flat",onPress:h,startContent:e.jsx(d,{icon:"lucide:library",width:16}),children:"Media Library"})]})]})}),e.jsxs(M,{className:"space-y-4",children:[s.length>0&&e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:s.map((u,m)=>e.jsxs("div",{className:"relative group",children:[e.jsxs("div",{className:"aspect-square rounded-lg overflow-hidden border-2 border-default-200",children:[u?e.jsx(ls,{src:u,alt:`Gallery image ${m+1}`,className:"w-full h-full object-cover",fallback:e.jsx("div",{className:"w-full h-full bg-default-100 flex items-center justify-center",children:e.jsx(d,{icon:"lucide:image",width:32,className:"text-default-400"})})}):e.jsx("div",{className:"w-full h-full bg-default-100 flex items-center justify-center",children:e.jsx(d,{icon:"lucide:image-plus",width:32,className:"text-default-400"})}),e.jsx("div",{className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsxs(be,{children:[e.jsx(ye,{children:e.jsx(_,{isIconOnly:!0,size:"sm",variant:"solid",color:"default",className:"bg-black/50 text-white",children:e.jsx(d,{icon:"lucide:more-vertical",width:16})})}),e.jsxs(we,{children:[e.jsx(ee,{startContent:e.jsx(d,{icon:"lucide:edit",width:16}),onPress:()=>{const p=prompt("Enter image URL:",u);p!==null&&n(m,p)},children:"Edit URL"},"edit"),e.jsx(ee,{className:"text-danger",color:"danger",startContent:e.jsx(d,{icon:"lucide:trash",width:16}),onPress:()=>l(m),children:"Remove"},"remove")]})]})})]}),e.jsx(Q,{placeholder:"Image URL",value:u,onChange:p=>n(m,p.target.value),size:"sm",className:"mt-2",classNames:{input:"urbana-input"}})]},m))}),e.jsx(ns,{}),e.jsx("div",{className:"flex justify-center",children:e.jsx(_,{variant:"dashed",onPress:o,startContent:e.jsx(d,{icon:"lucide:plus",width:16}),className:"w-full",children:"Add Image"})})]})]})},Qt=({specifications:s,onSpecificationsChange:r})=>{const[t,a]=L.useState(""),i=E.useCallback(()=>{t.trim()&&!s.includes(t.trim())&&(r([...s,t.trim()]),a(""))},[t,s,r]),n=E.useCallback(o=>{r(s.filter(h=>h!==o))},[s,r]),l=E.useCallback(o=>{o.key==="Enter"&&i()},[i]);return e.jsxs(I,{children:[e.jsx(V,{className:"pb-3",children:e.jsx("h4",{className:"text-md font-semibold",children:"Product Specifications"})}),e.jsxs(M,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Q,{placeholder:"Add specification (e.g., Dimensions: 3.0m x 3.0m)",value:t,onChange:o=>a(o.target.value),onKeyPress:l,size:"sm",classNames:{input:"urbana-input"},className:"flex-1"}),e.jsx(_,{size:"sm",color:"primary",onPress:i,isDisabled:!t.trim()||s.includes(t.trim()),startContent:e.jsx(d,{icon:"lucide:plus",width:16}),children:"Add"})]}),s.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("span",{className:"text-sm font-medium",children:["Specifications (",s.length,")"]})}),e.jsx("div",{className:"space-y-2",children:s.map((o,h)=>e.jsxs("div",{className:"flex justify-between items-center p-3 bg-default-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-6 h-6 bg-primary-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-xs font-semibold text-primary-600",children:h+1})}),e.jsx("span",{className:"text-sm flex-1",children:o})]}),e.jsx(_,{size:"sm",variant:"light",color:"danger",onPress:()=>n(o),startContent:e.jsx(d,{icon:"lucide:x",width:14}),children:"Remove"})]},h))})]})]})]})};class de{static generateAssetStructure(r,t,a,i){const n=[];return a.forEach(l=>{var S,C;const o=(S=Object.entries(i.rangeToProducts).find(([F,z])=>z.includes(l.id)))==null?void 0:S[0];if(!o)return;const h=t.find(F=>F.id===o);if(!h)return;const x=(C=Object.entries(i.groupToRanges).find(([F,z])=>z.includes(o)))==null?void 0:C[0];if(!x)return;const u=r.find(F=>F.id===x);if(!u)return;const m=this.sanitizePathSegment(u.name),p=this.sanitizePathSegment(h.name),b=this.sanitizePathSegment(l.code),v={category:u.name.toLowerCase(),range:h.name.toLowerCase().replace(/\s+/g,"-"),productCode:l.code.toLowerCase(),paths:{imagesPath:`${this.baseAssetsPath}/${m}/${p}/${b}/images`,downloadsPath:`${this.baseAssetsPath}/${m}/${p}/${b}/downloads`,fullImagePath:`/wp-content/plugins/urbana/${this.baseAssetsPath}/${m}/${p}/${b}/images`,fullDownloadPath:`/wp-content/plugins/urbana/${this.baseAssetsPath}/${m}/${p}/${b}/downloads`}};n.push(v)}),n}static sanitizePathSegment(r){return r.toLowerCase().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim()}static async generateFoldersAPI(r){var t;try{const a=await fetch("/wp-json/urbana/v1/generate-asset-folders",{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":((t=window.urbanaAdmin)==null?void 0:t.nonce)||""},body:JSON.stringify({structures:r.map(n=>({category:n.category,range:n.range,productCode:n.productCode,imagesPath:n.paths.imagesPath,downloadsPath:n.paths.downloadsPath}))})});if(!a.ok)throw new Error(`Failed to generate folders: ${a.status} ${a.statusText}`);return await a.json()}catch(a){throw console.error("Error generating folders:",a),a}}static async debugPaths(){var r;try{const t=await fetch("/wp-json/urbana/v1/debug-paths",{method:"GET",headers:{"Content-Type":"application/json","X-WP-Nonce":((r=window.urbanaAdmin)==null?void 0:r.nonce)||""}});if(!t.ok)throw new Error(`Failed to get debug info: ${t.status} ${t.statusText}`);return await t.json()}catch(t){throw console.error("Error getting debug info:",t),t}}static generateFolderPreview(r){const t=[];return r.forEach(a=>{t.push(a.paths.imagesPath),t.push(a.paths.downloadsPath)}),[...new Set(t)].sort()}static updateProductPaths(r,t){return r.map(a=>{const i=t.find(o=>o.productCode===a.code.toLowerCase());if(!i)return a;const n=a.imageGallery.length>0?a.imageGallery.map((o,h)=>!o||o.includes("shelter/")||o.includes("toilet/")||o.includes("bridge/")||o.includes("access/")?`${i.paths.imagesPath}/image-${h+1}.jpg`:o):[`${i.paths.imagesPath}/hero-image.jpg`],l={};return Object.entries(a.files).forEach(([o,h])=>{h.includes("/")?l[o]=h:l[o]=`${i.paths.downloadsPath}/${h}`}),{...a,imageGallery:n,files:l}})}static async fetchAndUpdateAllProductAssets(r,t,a,i,n,l){var h;if(this.generateAssetStructure(r,t,a,i).length===0)return{success:!1,updatedCount:0,message:"No products found with proper group/range relationships."};try{const x=await fetch("/wp-json/urbana/v1/fetch-all-product-assets",{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":((h=window.urbanaAdmin)==null?void 0:h.nonce)||""},body:JSON.stringify({stepperID:l||1})});if(!x.ok)throw new Error(`Failed to fetch assets: ${x.status}`);const u=await x.json();if(u.success){let m=0;return Object.entries(u.productAssets).forEach(([p,b])=>{const v=a.find(S=>S.code===p);v?(n(v.id,{imageGallery:b.images||[],files:b.files||{}}),m++):console.warn("Product not found for code:",p)}),{success:!0,updatedCount:m,message:`Successfully updated ${m} products with their assets.`}}else return{success:!1,updatedCount:0,message:"Failed to fetch assets: "+u.message}}catch(x){throw console.error("Error fetching all product assets:",x),x}}}hs(de,"baseAssetsPath","assets/products");const er=({stepperID:s})=>{const{products:r,productRanges:t,productGroups:a,addProduct:i,updateProduct:n,removeProduct:l,linkProductToRange:o,unlinkProductFromRange:h,relationships:x}=se(),{isOpen:u,onOpen:m,onOpenChange:p,onClose:b}=ve(),[v,S]=L.useState(null),[C,F]=L.useState({code:"",name:"",overview:"",description:"",specifications:[],imageGallery:[],files:{}}),[z,B]=L.useState(new Set),[D,A]=L.useState({}),f=E.useMemo(()=>{var te,re;if(!v)return null;const N=(te=Object.entries(x.rangeToProducts).find(([K,ae])=>ae.includes(v.id)))==null?void 0:te[0];if(!N)return null;const g=t.find(K=>K.id===N);if(!g)return null;const $=(re=Object.entries(x.groupToRanges).find(([K,ae])=>ae.includes(N)))==null?void 0:re[0];if(!$)return null;const U=a.find(K=>K.id===$);return U?{category:U.name,range:g.name,productCode:v.code}:null},[v,x,t,a]),k=E.useCallback(async()=>{if(confirm("This will fetch images and files from plugin folders for ALL products and update their data. This action cannot be undone. Continue?"))try{const g=await de.fetchAndUpdateAllProductAssets(a,t,r,x,n,s);H({color:g.success?"success":g.updatedCount===0?"warning":"danger",title:g.message})}catch(g){console.error("Error fetching all product assets:",g),H({color:"danger",title:"Error fetching assets. Please check console for details."})}},[n]),w=E.useCallback(()=>{S(null),F({code:"",name:"",overview:"",description:"",specifications:[],imageGallery:[],files:{}}),B(new Set),A({}),m()},[m]),y=E.useCallback(N=>{S(N),F({code:N.code,name:N.name,overview:N.overview,description:N.description,specifications:[...N.specifications],imageGallery:[...N.imageGallery],files:{...N.files}});const g=new Set;Object.entries(x.rangeToProducts).forEach(([$,U])=>{U.includes(N.id)&&g.add($)}),B(g),A({}),m()},[x.rangeToProducts,m]),c=E.useCallback(N=>{confirm("Are you sure you want to delete this product?")&&l(N)},[l]),P=E.useCallback((N,g)=>{if(F($=>({...$,[N]:g})),N==="name"&&!C.code&&typeof g=="string"){const $=g.toUpperCase().replace(/\s+/g,"-").replace(/[^A-Z0-9-]/g,"");F(U=>({...U,code:$}))}D[N]&&A($=>({...$,[N]:""}))},[C.code,D]),T=E.useCallback(()=>{const N={};return C.code.trim()||(N.code="Product code is required"),r.some($=>$.code.toLowerCase()===C.code.toLowerCase()&&(!v||$.id!==v.id))&&(N.code="A product with this code already exists"),C.name.trim()||(N.name="Product name is required"),C.overview.trim()||(N.overview="Product overview is required"),C.description.trim()||(N.description="Product description is required"),z.size===0&&(N.ranges="Please select at least one product range"),A(N),Object.keys(N).length===0},[C,r,v,z]),G=E.useCallback(()=>{if(!T())return;let N;v?(n(v.id,C),N=v.id,Object.keys(x.rangeToProducts).forEach(g=>{h(g,v.id)})):(i(C),N=(C.code||C.name).toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,"")),z.forEach(g=>{o(g,N)}),b()},[T,v,n,C,x.rangeToProducts,h,i,z,o,b]),j=E.useCallback(()=>{const N={},g=[];return r.forEach($=>{let U=!1;Object.entries(x.rangeToProducts).forEach(([te,re])=>{if(re.includes($.id)){const K=t.find(ae=>ae.id===te);K&&(N[K.name]||(N[K.name]=[]),N[K.name].push($),U=!0)}}),U||g.push($)}),{grouped:N,ungrouped:g}},[r,x.rangeToProducts,t]),{grouped:R,ungrouped:O}=j();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Products"}),e.jsx("p",{className:"text-sm text-foreground-500",children:"Manage individual products with detailed specifications"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(_,{color:"secondary",variant:"flat",onPress:k,startContent:e.jsx(d,{icon:"lucide:refresh-cw",width:18}),isDisabled:r.length===0,children:"Refetch All Assets"}),e.jsx(_,{color:"primary",onPress:w,startContent:e.jsx(d,{icon:"lucide:plus",width:18}),isDisabled:t.length===0,children:"Add Product"})]})]}),t.length===0?e.jsx(I,{children:e.jsx(M,{className:"text-center py-12",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx(d,{icon:"lucide:alert-circle",width:48,className:"text-warning-500"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground-600",children:"No Product Ranges Available"}),e.jsx("p",{className:"text-sm text-foreground-500",children:"You need to create product ranges first before adding products"})]})]})})}):r.length===0?e.jsx(I,{children:e.jsx(M,{className:"text-center py-12",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx(d,{icon:"lucide:package",width:48,className:"text-foreground-300"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground-600",children:"No Products Yet"}),e.jsx("p",{className:"text-sm text-foreground-500",children:"Create your first product to get started"})]}),e.jsx(_,{color:"primary",onPress:w,startContent:e.jsx(d,{icon:"lucide:plus",width:18}),children:"Add Product"})]})})}):e.jsxs("div",{className:"space-y-6",children:[Object.entries(R).map(([N,g])=>e.jsxs("div",{children:[e.jsxs("h4",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:[e.jsx(d,{icon:"lucide:grid-3x3",width:18}),N,e.jsxs(W,{size:"sm",variant:"flat",children:[g.length," product",g.length!==1?"s":""]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:g.map($=>e.jsx(is,{product:$,onEdit:y,onDelete:c},$.id))})]},N)),O.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-lg font-semibold mb-3 flex items-center gap-2 text-warning-600",children:[e.jsx(d,{icon:"lucide:alert-triangle",width:18}),"Ungrouped Products",e.jsxs(W,{size:"sm",variant:"flat",color:"warning",children:[O.length," product",O.length!==1?"s":""]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:O.map(N=>e.jsx(is,{product:N,onEdit:y,onDelete:c},N.id))})]})]}),e.jsx(Ne,{isDismissable:!1,isKeyboardDismissDisabled:!0,isOpen:u,onOpenChange:p,size:"4xl",scrollBehavior:"inside",className:"urbana-modal",children:e.jsx(Pe,{children:N=>e.jsxs(e.Fragment,{children:[e.jsx(Ce,{children:v?"Edit Product":"Add Product"}),e.jsx(Re,{children:e.jsxs(Be,{"aria-label":"Product Details",defaultSelectedKey:"basic",children:[e.jsx(q,{title:"Basic Info",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(Q,{label:"Product Code",placeholder:"e.g., SH-PEN-001",value:C.code,onChange:g=>P("code",g.target.value),errorMessage:D.code,isInvalid:!!D.code,isRequired:!0,classNames:{input:"urbana-input"}}),e.jsx(Q,{label:"Product Name",placeholder:"Enter product name",value:C.name,onChange:g=>P("name",g.target.value),errorMessage:D.name,isInvalid:!!D.name,isRequired:!0,classNames:{input:"urbana-input"}})]}),e.jsx(Oe,{label:"Product Ranges",placeholder:"Select product ranges",selectionMode:"multiple",selectedKeys:z,onSelectionChange:g=>B(g),errorMessage:D.ranges,isInvalid:!!D.ranges,isRequired:!0,children:t.map(g=>e.jsx(ze,{children:g.name},g.id))}),e.jsx(xe,{label:"Overview",placeholder:"Brief product overview",value:C.overview,onChange:g=>P("overview",g.target.value),errorMessage:D.overview,isInvalid:!!D.overview,isRequired:!0,rows:2,classNames:{input:"urbana-input"}}),e.jsx(xe,{label:"Description",placeholder:"Detailed product description",value:C.description,onChange:g=>P("description",g.target.value),errorMessage:D.description,isInvalid:!!D.description,isRequired:!0,rows:4,classNames:{input:"urbana-input"}})]})},"basic"),e.jsx(q,{title:"Specifications",children:e.jsx(Qt,{specifications:C.specifications,onSpecificationsChange:g=>P("specifications",g)})},"specifications"),e.jsx(q,{title:"Images",children:e.jsx(Zt,{imageGallery:C.imageGallery,onImageGalleryChange:g=>P("imageGallery",g),productCode:(f==null?void 0:f.productCode)||C.code,category:f==null?void 0:f.category,range:f==null?void 0:f.range})},"images"),e.jsx(q,{title:"Files",children:e.jsx(Xt,{files:C.files,onFilesChange:g=>P("files",g),productCode:(f==null?void 0:f.productCode)||C.code,category:f==null?void 0:f.category,range:f==null?void 0:f.range})},"files")]})}),e.jsxs(Se,{children:[e.jsx(_,{variant:"light",onPress:N,children:"Cancel"}),e.jsxs(_,{color:"primary",onPress:G,children:[v?"Update":"Add"," Product"]})]})]})})})]})},is=L.memo(({product:s,onEdit:r,onDelete:t})=>{const a=s.imageGallery.length>0&&s.imageGallery[0];return e.jsxs(I,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(V,{className:"pb-3",children:e.jsxs("div",{className:"flex justify-between items-start w-full",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[a?e.jsx(ls,{src:s.imageGallery[0],alt:s.name,width:40,height:40,className:"rounded-lg object-cover"}):e.jsx("div",{className:"w-10 h-10 bg-success-100 rounded-lg flex items-center justify-center",children:e.jsx(d,{icon:"lucide:package",width:20,className:"text-success-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold",children:s.name}),e.jsx(W,{size:"sm",variant:"flat",color:"success",children:s.code})]})]}),e.jsxs(be,{children:[e.jsx(ye,{children:e.jsx(_,{isIconOnly:!0,variant:"light",size:"sm",children:e.jsx(d,{icon:"lucide:more-vertical",width:16})})}),e.jsxs(we,{"aria-label":"Product Actions",children:[e.jsx(ee,{startContent:e.jsx(d,{icon:"lucide:edit",width:16}),onPress:()=>r(s),children:"Edit"},"edit"),e.jsx(ee,{className:"text-danger",color:"danger",startContent:e.jsx(d,{icon:"lucide:trash",width:16}),onPress:()=>t(s.id),children:"Delete"},"delete")]})]})]})}),e.jsxs(M,{className:"pt-0",children:[e.jsx("p",{className:"text-sm text-foreground-600 mb-2",children:s.overview}),s.specifications.length>0&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs font-semibold text-foreground-700",children:"Specifications:"}),e.jsxs("div",{className:"text-xs text-foreground-500",children:[s.specifications.slice(0,3).map((i,n)=>e.jsxs("div",{children:["• ",i]},n)),s.specifications.length>3&&e.jsxs("div",{children:["... and ",s.specifications.length-3," more"]})]})]})]})]})});is.displayName="ProductCard";const sr=()=>{const{productGroups:s,productRanges:r,products:t,relationships:a,linkRangeToGroup:i,unlinkRangeFromGroup:n,linkProductToRange:l,unlinkProductFromRange:o}=se(),[h,x]=L.useState(null),[u,m]=L.useState(null),[p,b]=L.useState(!1),v=()=>s.map(c=>{const P=a.groupToRanges[c.id]||[],T=P.map(G=>{const j=r.find(N=>N.id===G),R=a.rangeToProducts[G]||[],O=R.map(N=>{const g=t.find($=>$.id===N);return{id:N,name:(g==null?void 0:g.name)||"Unknown Product",code:g==null?void 0:g.code,overview:g==null?void 0:g.overview,type:"product",hasIssues:!g}}).filter(Boolean);return{id:G,name:(j==null?void 0:j.name)||"Unknown Range",description:j==null?void 0:j.description,type:"range",children:O,hasIssues:!j||R.length===0}}).filter(Boolean);return{id:c.id,name:c.name,description:c.description,type:"group",children:T,hasIssues:P.length===0}}),S=()=>{const c=r.filter(T=>!Object.values(a.groupToRanges).some(G=>G.includes(T.id))),P=t.filter(T=>!Object.values(a.rangeToProducts).some(G=>G.includes(T.id)));return{orphanedRanges:c,orphanedProducts:P}},C=()=>{const{orphanedRanges:c,orphanedProducts:P}=S(),T=Object.values(a.groupToRanges).reduce((j,R)=>j+R.length,0)+Object.values(a.rangeToProducts).reduce((j,R)=>j+R.length,0),G=Math.round((s.length-s.filter(j=>(a.groupToRanges[j.id]||[]).length===0).length+(r.length-c.length)+(t.length-P.length))/(s.length+r.length+t.length)*100);return{totalConnections:T,orphanedRanges:c.length,orphanedProducts:P.length,completionRate:isNaN(G)?0:G}},F=(c,P)=>{i(c,P)},z=(c,P)=>{n(c,P)},B=(c,P)=>{l(c,P)},D=(c,P)=>{o(c,P)},A=async()=>{b(!0),await new Promise(c=>setTimeout(c,1500)),b(!1)},f=v(),{orphanedRanges:k,orphanedProducts:w}=S(),y=C();return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Relationship Manager"}),e.jsx("p",{className:"text-sm text-foreground-500",children:"Manage connections between groups, ranges, and products"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx(_,{color:"secondary",variant:"flat",onPress:A,startContent:e.jsx(d,{icon:"lucide:search",width:18}),isLoading:p,children:p?"Analyzing...":"Analyze Structure"})})]}),e.jsx(I,{className:"mb-6",children:e.jsx(M,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-primary-600",children:y.totalConnections}),e.jsx("div",{className:"text-sm text-foreground-500",children:"Total Connections"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-warning-600",children:y.orphanedRanges}),e.jsx("div",{className:"text-sm text-foreground-500",children:"Orphaned Ranges"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-danger-600",children:y.orphanedProducts}),e.jsx("div",{className:"text-sm text-foreground-500",children:"Orphaned Products"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-success-600",children:[y.completionRate,"%"]}),e.jsx("div",{className:"text-sm text-foreground-500",children:"Structure Complete"}),e.jsx(Ms,{value:y.completionRate,color:y.completionRate>80?"success":y.completionRate>50?"warning":"danger",size:"sm",className:"mt-1"})]})]})})}),e.jsxs(Be,{"aria-label":"Relationship Views",defaultSelectedKey:"tree",children:[e.jsx(q,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{icon:"lucide:git-branch",width:16}),"Tree View"]}),children:e.jsxs("div",{className:"space-y-4",children:[f.length===0?e.jsx(I,{children:e.jsx(M,{className:"text-center py-12",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx(d,{icon:"lucide:git-branch",width:48,className:"text-foreground-300"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground-600",children:"No Structure Yet"}),e.jsx("p",{className:"text-sm text-foreground-500",children:"Create groups, ranges, and products to see the relationship tree"})]})]})})}):e.jsx(Es,{selectionMode:"multiple",variant:"bordered",children:f.map(c=>{var P;return e.jsx(Ts,{title:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ue,{icon:e.jsx(d,{icon:"lucide:folder",width:16}),className:"w-6 h-6 bg-primary-100 text-primary-600"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-semibold",children:c.name}),c.hasIssues&&e.jsx(d,{icon:"lucide:alert-triangle",width:16,className:"text-warning-500"})]}),e.jsx("div",{className:"text-xs text-foreground-500",children:c.description||"No description"})]}),e.jsx(gs,{content:((P=c.children)==null?void 0:P.length)||0,color:"primary",size:"sm",children:e.jsx("div",{className:"w-4 h-4"})})]}),children:c.children&&c.children.length>0?e.jsx("div",{className:"space-y-3 pl-4",children:c.children.map(T=>{var G;return e.jsxs("div",{className:"border-l-2 border-gray-200 pl-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(ue,{icon:e.jsx(d,{icon:"lucide:grid-3x3",width:16}),className:"w-6 h-6 bg-secondary-100 text-secondary-600"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:T.name}),T.hasIssues&&e.jsx(d,{icon:"lucide:alert-triangle",width:16,className:"text-warning-500"})]}),e.jsx("div",{className:"text-xs text-foreground-500",children:T.description||"No description"})]}),e.jsx(gs,{content:((G=T.children)==null?void 0:G.length)||0,color:"secondary",size:"sm",children:e.jsx("div",{className:"w-4 h-4"})})]}),T.children&&T.children.length>0&&e.jsx("div",{className:"space-y-2 pl-8",children:T.children.map(j=>e.jsxs("div",{className:"flex items-center gap-3 p-2 bg-gray-50 rounded-lg",children:[e.jsx(ue,{icon:e.jsx(d,{icon:"lucide:package",width:16}),className:"w-5 h-5 bg-success-100 text-success-600"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:j.name}),j.code&&e.jsx(W,{size:"sm",variant:"flat",color:"success",children:j.code}),j.hasIssues&&e.jsx(d,{icon:"lucide:alert-triangle",width:14,className:"text-warning-500"})]}),j.overview&&e.jsx("div",{className:"text-xs text-foreground-500",children:j.overview})]})]},j.id))})]},T.id)})}):e.jsxs("div",{className:"text-center py-6 text-foreground-400",children:[e.jsx(d,{icon:"lucide:inbox",width:32,className:"mx-auto mb-2"}),e.jsx("p",{className:"text-sm",children:"No ranges linked to this group"})]})},c.id)})}),(k.length>0||w.length>0)&&e.jsxs(I,{className:"border-warning-200 bg-warning-50",children:[e.jsx(V,{children:e.jsxs("div",{className:"flex items-center gap-2 text-warning-700",children:[e.jsx(d,{icon:"lucide:alert-triangle",width:20}),e.jsx("h4",{className:"font-semibold",children:"Orphaned Items"})]})}),e.jsxs(M,{className:"pt-0",children:[k.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h5",{className:"font-medium text-sm mb-2",children:"Unlinked Ranges:"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:k.map(c=>e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-white rounded border",children:[e.jsx(d,{icon:"lucide:grid-3x3",width:16,className:"text-secondary-600"}),e.jsx("span",{className:"text-sm",children:c.name}),e.jsx("span",{className:"text-xs text-gray-500",children:c.description})]},c.id))})]}),w.length>0&&e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-sm mb-2",children:"Unlinked Products:"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:w.map(c=>e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-white rounded border",children:[e.jsx(d,{icon:"lucide:package",width:16,className:"text-success-600"}),e.jsx("span",{className:"text-sm",children:c.name}),e.jsx(W,{size:"sm",variant:"flat",color:"success",children:c.code})]},c.id))})]})]})]})]})},"tree"),e.jsx(q,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{icon:"lucide:link",width:16}),"Manage Links"]}),children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(I,{children:[e.jsx(V,{children:e.jsxs("h4",{className:"font-semibold flex items-center gap-2",children:[e.jsx(d,{icon:"lucide:arrow-right",width:16}),"Group → Range Links"]})}),e.jsx(M,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(Oe,{label:"Select Group",placeholder:"Choose a product group",selectedKeys:h?new Set([h]):new Set,onSelectionChange:c=>x(Array.from(c)[0]||null),children:s.map(c=>e.jsx(ze,{children:c.name},c.id))}),h&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-sm font-medium text-foreground-700",children:"Available Ranges:"}),r.map(c=>{const P=(a.groupToRanges[h]||[]).includes(c.id);return e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(d,{icon:"lucide:grid-3x3",width:16,className:"text-secondary-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-sm",children:c.name}),e.jsx("div",{className:"text-xs text-foreground-500",children:c.description})]})]}),e.jsx(_,{size:"sm",color:P?"danger":"primary",variant:P?"flat":"solid",onPress:()=>{P?z(h,c.id):F(h,c.id)},children:P?"Unlink":"Link"})]},c.id)})]})]})})]}),e.jsxs(I,{children:[e.jsx(V,{children:e.jsxs("h4",{className:"font-semibold flex items-center gap-2",children:[e.jsx(d,{icon:"lucide:arrow-right",width:16}),"Range → Product Links"]})}),e.jsx(M,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(Oe,{label:"Select Range",placeholder:"Choose a product range",selectedKeys:u?new Set([u]):new Set,onSelectionChange:c=>m(Array.from(c)[0]||null),children:r.map(c=>e.jsx(ze,{children:c.name},c.id))}),u&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-sm font-medium text-foreground-700",children:"Available Products:"}),t.map(c=>{const P=(a.rangeToProducts[u]||[]).includes(c.id);return e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(d,{icon:"lucide:package",width:16,className:"text-success-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-sm",children:c.name}),e.jsx("div",{className:"text-xs text-foreground-500",children:c.code})]})]}),e.jsx(_,{size:"sm",color:P?"danger":"primary",variant:P?"flat":"solid",onPress:()=>{P?D(u,c.id):B(u,c.id)},children:P?"Unlink":"Link"})]},c.id)})]})]})})]})]})},"manage"),e.jsx(q,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{icon:"lucide:bar-chart-3",width:16}),"Analysis"]}),children:e.jsx("div",{className:"space-y-6",children:p?e.jsx(I,{children:e.jsxs(M,{className:"text-center py-12",children:[e.jsx(As,{size:"lg",color:"primary"}),e.jsx("p",{className:"mt-4 text-foreground-600",children:"Analyzing relationship structure..."})]})}):e.jsxs(e.Fragment,{children:[e.jsxs(I,{children:[e.jsx(V,{children:e.jsx("h4",{className:"font-semibold",children:"Structure Analysis"})}),e.jsx(M,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-sm mb-2",children:"Groups"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Total Groups"}),e.jsx("span",{className:"text-sm font-medium",children:s.length})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"With Ranges"}),e.jsx("span",{className:"text-sm font-medium",children:s.filter(c=>(a.groupToRanges[c.id]||[]).length>0).length})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Empty Groups"}),e.jsx("span",{className:"text-sm font-medium text-warning-600",children:s.filter(c=>(a.groupToRanges[c.id]||[]).length===0).length})]})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-sm mb-2",children:"Ranges"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Total Ranges"}),e.jsx("span",{className:"text-sm font-medium",children:r.length})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Linked to Groups"}),e.jsx("span",{className:"text-sm font-medium",children:r.length-k.length})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"With Products"}),e.jsx("span",{className:"text-sm font-medium",children:r.filter(c=>(a.rangeToProducts[c.id]||[]).length>0).length})]})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-sm mb-2",children:"Products"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Total Products"}),e.jsx("span",{className:"text-sm font-medium",children:t.length})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Linked to Ranges"}),e.jsx("span",{className:"text-sm font-medium",children:t.length-w.length})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Orphaned"}),e.jsx("span",{className:"text-sm font-medium text-danger-600",children:w.length})]})]})]})]})})]}),e.jsxs(I,{children:[e.jsx(V,{children:e.jsxs("h4",{className:"font-semibold flex items-center gap-2",children:[e.jsx(d,{icon:"lucide:lightbulb",width:16}),"Recommendations"]})}),e.jsx(M,{children:e.jsxs("div",{className:"space-y-3",children:[y.orphanedProducts>0&&e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-danger-50 rounded-lg border border-danger-200",children:[e.jsx(d,{icon:"lucide:alert-triangle",width:16,className:"text-danger-600 mt-0.5"}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium text-danger-800",children:["You have ",y.orphanedProducts," unlinked product",y.orphanedProducts!==1?"s":""]}),e.jsx("p",{className:"text-xs text-danger-600",children:"Link these products to ranges so they appear in your product stepper."})]})]}),y.orphanedRanges>0&&e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-warning-50 rounded-lg border border-warning-200",children:[e.jsx(d,{icon:"lucide:alert-triangle",width:16,className:"text-warning-600 mt-0.5"}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium text-warning-800",children:["You have ",y.orphanedRanges," unlinked range",y.orphanedRanges!==1?"s":""]}),e.jsx("p",{className:"text-xs text-warning-600",children:"Link these ranges to product groups to organize your structure."})]})]}),s.filter(c=>(a.groupToRanges[c.id]||[]).length===0).length>0&&e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-primary-50 rounded-lg border border-primary-200",children:[e.jsx(d,{icon:"lucide:info",width:16,className:"text-primary-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-primary-800",children:"Some product groups are empty"}),e.jsx("p",{className:"text-xs text-primary-600",children:"Consider linking ranges to these groups or removing unused groups."})]})]}),y.completionRate>=90&&e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-success-50 rounded-lg border border-success-200",children:[e.jsx(d,{icon:"lucide:check-circle",width:16,className:"text-success-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-success-800",children:"Great job! Your structure is well organized"}),e.jsx("p",{className:"text-xs text-success-600",children:"Your data structure is ready for the product stepper."})]})]})]})})]})]})})},"analysis")]})]})},tr=()=>{const{productGroups:s,productRanges:r,products:t,relationships:a,exportData:i,importData:n}=se(),{isOpen:l,onOpen:o,onOpenChange:h,onClose:x}=ve(),[u,m]=L.useState(""),[p,b]=L.useState(""),[v,S]=L.useState("structure"),C=()=>({stepperForm:{steps:s.map((y,c)=>{const P=a.groupToRanges[y.id]||[],T=P.map(j=>{const R=r.find(O=>O.id===j);return(R==null?void 0:R.name)||"Unknown Range"}),G={};return P.forEach(j=>{const R=r.find(O=>O.id===j);if(R){const O=a.rangeToProducts[j]||[];G[R.name]=O.map(N=>{const g=t.find($=>$.id===N);return{id:(g==null?void 0:g.id)||N,code:(g==null?void 0:g.code)||"",name:(g==null?void 0:g.name)||"Unknown Product",overview:(g==null?void 0:g.overview)||"",description:(g==null?void 0:g.description)||"",specifications:(g==null?void 0:g.specifications)||[],imageGallery:(g==null?void 0:g.imageGallery)||[],files:(g==null?void 0:g.files)||{}}})}}),{step:c+1,title:y.name,categories:T.length>0?T:void 0,products:G}})}}),F=()=>{const w=i();b(JSON.stringify(w,null,2)),S("json")},z=()=>{try{const w=JSON.parse(u);n(w),m(""),x()}catch{alert("Invalid JSON format. Please check your data.")}},B=()=>{const w=C(),y=JSON.stringify(w,null,2),c="data:application/json;charset=utf-8,"+encodeURIComponent(y),P="stepper-config.json",T=document.createElement("a");T.setAttribute("href",c),T.setAttribute("download",P),T.click()},D=()=>{const w=C();navigator.clipboard.writeText(JSON.stringify(w,null,2))},A=C(),f={};A.stepperForm.steps.forEach(w=>{w.products&&Object.entries(w.products).forEach(([y,c])=>{f[y]||(f[y]=[]),f[y].push(...c)})});const k={totalSteps:A.stepperForm.steps.length,totalCategories:Object.keys(f).length,totalProducts:Object.values(f).reduce((w,y)=>w+y.length,0),hasIssues:A.stepperForm.steps.some(w=>!w.categories||w.categories.length===0)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Data Preview"}),e.jsx("p",{className:"text-sm text-foreground-500",children:"Preview and export your stepper configuration"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(_,{variant:"flat",onPress:o,startContent:e.jsx(d,{icon:"lucide:upload",width:18}),children:"Import"}),e.jsx(_,{color:"secondary",onPress:F,startContent:e.jsx(d,{icon:"lucide:download",width:18}),children:"Export Data"}),e.jsx(_,{color:"primary",onPress:B,startContent:e.jsx(d,{icon:"lucide:file-down",width:18}),children:"Download Config"})]})]}),e.jsx(I,{className:"mb-6",children:e.jsx(M,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-primary-600",children:k.totalSteps}),e.jsx("div",{className:"text-sm text-foreground-500",children:"Stepper Steps"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-secondary-600",children:k.totalCategories}),e.jsx("div",{className:"text-sm text-foreground-500",children:"Categories"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-success-600",children:k.totalProducts}),e.jsx("div",{className:"text-sm text-foreground-500",children:"Products"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`text-2xl font-bold ${k.hasIssues?"text-warning-600":"text-success-600"}`,children:k.hasIssues?e.jsx(d,{icon:"lucide:alert-triangle",width:32}):e.jsx(d,{icon:"lucide:check-circle",width:32})}),e.jsx("div",{className:"text-sm text-foreground-500",children:k.hasIssues?"Has Issues":"Ready"})]})]})})}),e.jsxs(Be,{"aria-label":"Preview Options",selectedKey:v,onSelectionChange:w=>S(w),children:[e.jsx(q,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{icon:"lucide:layers",width:16}),"Structure Preview"]}),children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs(I,{children:[e.jsx(V,{children:e.jsxs("h4",{className:"font-semibold flex items-center gap-2",children:[e.jsx(d,{icon:"lucide:list",width:16}),"Stepper Steps"]})}),e.jsx(M,{children:A.stepperForm.steps.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(d,{icon:"lucide:layers",width:48,className:"mx-auto text-foreground-300 mb-4"}),e.jsx("p",{className:"text-foreground-600",children:"No stepper steps configured"}),e.jsx("p",{className:"text-sm text-foreground-500",children:"Create product groups to generate stepper steps"})]}):e.jsx("div",{className:"space-y-4",children:A.stepperForm.steps.map(w=>e.jsxs("div",{className:"flex items-center gap-4 p-4 border rounded-lg",children:[e.jsx("div",{className:"w-8 h-8 bg-primary-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-bold text-primary-600",children:w.step})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h5",{className:"font-semibold",children:w.title}),w.categories&&w.categories.length>0?e.jsx("div",{className:"flex gap-1 mt-1",children:w.categories.map((y,c)=>e.jsx(W,{size:"sm",variant:"flat",color:"secondary",children:y},c))}):e.jsxs("p",{className:"text-sm text-warning-600 mt-1",children:[e.jsx(d,{icon:"lucide:alert-triangle",width:14,className:"inline mr-1"}),"No categories linked"]})]})]},w.step))})})]}),e.jsxs(I,{children:[e.jsx(V,{children:e.jsxs("h4",{className:"font-semibold flex items-center gap-2",children:[e.jsx(d,{icon:"lucide:package",width:16}),"Products by Category"]})}),e.jsx(M,{children:Object.keys(f).length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(d,{icon:"lucide:package",width:48,className:"mx-auto text-foreground-300 mb-4"}),e.jsx("p",{className:"text-foreground-600",children:"No products configured"}),e.jsx("p",{className:"text-sm text-foreground-500",children:"Link products to ranges to see them here"})]}):e.jsx(Es,{variant:"bordered",children:Object.entries(f).map(([w,y])=>e.jsx(Ts,{title:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ue,{icon:e.jsx(d,{icon:"lucide:grid-3x3",width:16}),className:"w-6 h-6 bg-secondary-100 text-secondary-600"}),e.jsx("span",{className:"font-medium",children:w}),e.jsxs(W,{size:"sm",variant:"flat",color:"secondary",children:[y.length," product",y.length!==1?"s":""]})]}),children:e.jsx("div",{className:"space-y-3 pl-4",children:y.map(c=>e.jsx("div",{className:"border-l-2 border-success-200 pl-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ue,{icon:e.jsx(d,{icon:"lucide:package",width:16}),className:"w-8 h-8 bg-success-100 text-success-600 mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h6",{className:"font-semibold",children:c.name}),e.jsx(W,{size:"sm",variant:"flat",color:"success",children:c.code})]}),e.jsx("p",{className:"text-sm text-foreground-600 mb-2",children:c.overview}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-foreground-700",children:"Specifications:"}),e.jsx("span",{className:"text-foreground-500 ml-1",children:c.specifications.length})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-foreground-700",children:"Images:"}),e.jsx("span",{className:"text-foreground-500 ml-1",children:c.imageGallery.length})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-foreground-700",children:"Files:"}),e.jsx("span",{className:"text-foreground-500 ml-1",children:Object.keys(c.files).length})]})]})]})]})},c.id))})},w))})})]})]})},"structure"),e.jsx(q,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{icon:"lucide:code",width:16}),"JSON Preview"]}),children:e.jsxs(I,{children:[e.jsxs(V,{className:"flex flex-row justify-between items-center",children:[e.jsx("h4",{className:"font-semibold",children:"Configuration JSON"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(_,{size:"sm",variant:"flat",onPress:D,startContent:e.jsx(d,{icon:"lucide:copy",width:16}),children:"Copy"}),e.jsx(_,{size:"sm",color:"primary",onPress:B,startContent:e.jsx(d,{icon:"lucide:download",width:16}),children:"Download"})]})]}),e.jsx(M,{children:e.jsx(kt,{className:"w-full max-h-96 overflow-auto text-xs",children:p||JSON.stringify(A,null,2)})})]})},"json")]}),e.jsx(Ne,{isOpen:l,onOpenChange:h,size:"2xl",children:e.jsx(Pe,{children:w=>e.jsxs(e.Fragment,{children:[e.jsx(Ce,{children:"Import Configuration"}),e.jsx(Re,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"p-3 bg-warning-50 border border-warning-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(d,{icon:"lucide:alert-triangle",width:16,className:"text-warning-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-warning-800",children:"Warning"}),e.jsx("p",{className:"text-xs text-warning-600",children:"Importing will replace all current data. Make sure to export your current configuration first if needed."})]})]})}),e.jsx(xe,{label:"JSON Data",placeholder:"Paste your exported JSON configuration here...",value:u,onChange:y=>m(y.target.value),rows:12,className:"font-mono text-sm"})]})}),e.jsxs(Se,{children:[e.jsx(_,{variant:"light",onPress:w,children:"Cancel"}),e.jsx(_,{color:"primary",onPress:z,isDisabled:!u.trim(),children:"Import"})]})]})})})]})},rr=({isOpen:s,onOpenChange:r})=>{const{productGroups:t,productRanges:a,products:i,relationships:n,updateProduct:l}=se(),[o,h]=L.useState([]),[x,u]=L.useState([]),[m,p]=L.useState(!1),[b,v]=L.useState(null),[S,C]=L.useState(!0),F=E.useMemo(()=>{const D=new Set(o.map(f=>f.category)),A=new Set(o.map(f=>f.range));return{products:o.length,folders:x.length,categories:D.size,ranges:A.size}},[o,x]);L.useEffect(()=>{if(s){const D=de.generateAssetStructure(t,a,i,n);h(D),u(de.generateFolderPreview(D)),v(null)}},[s,t,a,i,n]);const z=E.useCallback(async()=>{p(!0),v(null);try{const D=await de.generateFoldersAPI(o);v(D),S&&D.success?(de.updateProductPaths(i,o).forEach(f=>{l(f.id,{imageGallery:f.imageGallery,files:f.files})}),H({color:"success",title:"Folders created and product paths updated!"})):D.success?H({color:"success",title:D.message}):H({color:"danger",title:D.message})}catch(D){const A=D instanceof Error?D.message:"Unknown error occurred";v({success:!1,message:A,created:[]}),H({color:"danger",title:"Failed to generate folders",description:A})}finally{p(!1)}},[o,S,i,l]),B=E.useCallback(()=>{v(null),p(!1),r(!1)},[r]);return e.jsx(Ne,{isOpen:s,onOpenChange:r,size:"3xl",scrollBehavior:"inside",className:"urbana-modal",isDismissable:!m,children:e.jsx(Pe,{children:D=>e.jsxs(e.Fragment,{children:[e.jsxs(Ce,{className:"flex flex-col gap-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{icon:"lucide:folder-plus",width:20}),"Generate Asset Folders"]}),e.jsx("p",{className:"text-sm text-foreground-500 font-normal",children:"Create organized folder structure for product assets"})]}),e.jsx(Re,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(I,{className:"bg-gradient-to-r from-primary-50 to-secondary-50",children:e.jsx(M,{children:e.jsxs("div",{className:"grid grid-cols-4 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:F.products}),e.jsx("div",{className:"text-sm text-foreground-500",children:"Products"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-secondary",children:F.folders}),e.jsx("div",{className:"text-sm text-foreground-500",children:"Folders"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-success",children:F.categories}),e.jsx("div",{className:"text-sm text-foreground-500",children:"Categories"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-warning",children:F.ranges}),e.jsx("div",{className:"text-sm text-foreground-500",children:"Ranges"})]})]})})}),e.jsx(I,{children:e.jsx(M,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"font-semibold flex items-center gap-2",children:[e.jsx(d,{icon:"lucide:settings",width:16}),"Options"]}),e.jsx(xt,{isSelected:S,onValueChange:C,isDisabled:m,size:"sm",children:e.jsxs("div",{className:"ml-2",children:[e.jsx("div",{className:"font-medium",children:"Update product paths automatically"}),e.jsx("div",{className:"text-xs text-foreground-500",children:"This will update existing products to use the new folder structure paths"})]})})]})})}),e.jsx(I,{children:e.jsx(M,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h4",{className:"font-semibold flex items-center gap-2",children:[e.jsx(d,{icon:"lucide:eye",width:16}),"Folder Structure Preview"]}),e.jsxs(W,{size:"sm",variant:"flat",color:"primary",children:[x.length," folders"]})]}),e.jsx(xs,{className:"max-h-60",children:e.jsx("div",{className:"space-y-1 font-mono text-sm",children:x.map((A,f)=>e.jsxs("div",{className:"flex items-center gap-2 p-2 rounded-md hover:bg-default-100",children:[e.jsx(d,{icon:A.includes("/images")?"lucide:image":"lucide:file",width:14,className:A.includes("/images")?"text-primary":"text-secondary"}),e.jsx("span",{className:"text-foreground-700 break-all",children:A})]},f))})})]})})}),m&&e.jsx(I,{className:"border-primary",children:e.jsx(M,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{icon:"lucide:loader",width:16,className:"animate-spin text-primary"}),e.jsx("span",{className:"font-semibold",children:"Generating Folders..."})]}),e.jsx(Ms,{isIndeterminate:!0,color:"primary",size:"sm",className:"w-full"}),e.jsx("p",{className:"text-sm text-foreground-500",children:"Please wait while we create the folder structure..."})]})})}),b&&e.jsx(I,{className:b.success?"border-success":"border-danger",children:e.jsx(M,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{icon:b.success?"lucide:check-circle":"lucide:x-circle",width:16,className:b.success?"text-success":"text-danger"}),e.jsx("span",{className:"font-semibold",children:b.success?"Success!":"Error"})]}),e.jsx("p",{className:"text-sm",children:b.message}),b.created.length>0&&e.jsxs("div",{children:[e.jsx(ns,{className:"my-3"}),e.jsx("p",{className:"text-sm font-medium mb-2",children:"Created folders:"}),e.jsx(xs,{className:"max-h-32",children:e.jsx("div",{className:"space-y-1",children:b.created.map((A,f)=>e.jsxs("div",{className:"text-xs text-success-600 font-mono flex items-center gap-1",children:[e.jsx(d,{icon:"lucide:check",width:12}),A]},f))})})]})]})})}),!b&&e.jsx(I,{className:"bg-warning-50 border-warning",children:e.jsx(M,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"font-semibold text-warning-600 flex items-center gap-2",children:[e.jsx(d,{icon:"lucide:info",width:16}),"Instructions"]}),e.jsxs("ul",{className:"text-sm space-y-2 text-foreground-600",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(d,{icon:"lucide:check",width:14,className:"mt-0.5 text-success"}),"This will create physical folders in your plugin's assets directory"]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(d,{icon:"lucide:check",width:14,className:"mt-0.5 text-success"}),"Each product will get dedicated images/ and downloads/ folders"]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(d,{icon:"lucide:check",width:14,className:"mt-0.5 text-success"}),"Folder structure follows: category/range/product-code/"]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(d,{icon:"lucide:check",width:14,className:"mt-0.5 text-success"}),"README files will be created to guide file placement"]})]})]})})})]})}),e.jsxs(Se,{children:[e.jsx(_,{variant:"light",onPress:B,isDisabled:m,children:b?"Close":"Cancel"}),!b&&e.jsx(_,{color:"primary",onPress:z,isLoading:m,isDisabled:m||o.length===0,startContent:m?void 0:e.jsx(d,{icon:"lucide:folder-plus",width:16}),children:m?"Generating...":"Generate Folders"})]})]})})})},ar=()=>{const{productGroups:s,productRanges:r,products:t,relationships:a,exportData:i,importData:n,error:l,productData:o,loadData:h,saveData:x,isLoading:u,isSaving:m,isDirty:p,lastSaved:b,initializeFromWindowData:v,clearError:S}=se(),[C,F]=E.useState(null),{isOpen:z,onOpen:B,onOpenChange:D}=ve();E.useEffect(()=>{const y=window.urbanaAdmin;y&&(v(),F(y.stepperId||1))},[v]);const A=async()=>{try{S();const y=await x();y&&F(y),H({color:"success",title:"Data saved successfully!"})}catch(y){console.error("Failed to save data:",y),H({color:"danger",title:"Failed to save data. Please try again."})}},f=async y=>{try{const c=new URL(window.location.href);c.searchParams.set("stepper_id",y.toString()),window.location.href=c.toString()}catch(c){console.error("Failed to load data builder:",c),H({color:"danger",title:"Failed to load data builder"})}},k=()=>{try{const y=i(),c="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(y,null,2)),P=document.createElement("a");P.setAttribute("href",c),P.setAttribute("download","product-configurator-data.json"),document.body.appendChild(P),P.click(),P.remove(),H({color:"success",title:"Data exported successfully!"})}catch(y){console.error("Export failed:",y),H({color:"danger",title:"Failed to export data"})}},w=y=>{var T;const c=(T=y.target.files)==null?void 0:T[0];if(!c)return;const P=new FileReader;P.onload=G=>{var j;try{const R=JSON.parse((j=G.target)==null?void 0:j.result);n(R),y.target.value="",H({color:"success",title:"Data imported successfully!"})}catch(R){console.error("Error parsing imported data:",R),H({color:"danger",title:"Invalid data format. Please check your JSON file."})}},P.readAsText(c)};return e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-semibold text-foreground",children:["Data Management",C&&e.jsxs("span",{className:"text-sm text-foreground-500 ml-2",children:["(Stepper ID: ",C,")"]})]}),e.jsx("p",{className:"text-sm text-foreground-500 mt-1",children:"Manage product groups, ranges, products, and their relationships"})]})}),e.jsxs("div",{className:"flex gap-2",children:[b&&e.jsxs("div",{className:"text-sm text-foreground-500 text-right ml-6",children:[e.jsx("div",{className:"text-xs",children:"Last saved:"}),e.jsx("div",{className:"font-medium",children:new Date(b).toLocaleString()})]}),e.jsx(_,{color:p?"primary":"success",variant:p?"solid":"flat",onPress:A,isLoading:m,isDisabled:m,startContent:m?"":e.jsx(d,{icon:"lucide:save",width:18}),children:m?"Saving...":p?"Save Changes":"Save Data"}),e.jsx(_,{color:"primary",variant:"flat",onPress:k,startContent:e.jsx(d,{icon:"lucide:download",width:18}),children:"Export Data"}),e.jsxs("label",{className:"cursor-pointer",children:[e.jsx(_,{color:"primary",variant:"flat",as:"span",startContent:e.jsx(d,{icon:"lucide:upload",width:18}),children:"Import Data"}),e.jsx("input",{type:"file",accept:".json",className:"hidden",onChange:w})]}),e.jsx(_,{color:"secondary",variant:"flat",onPress:B,startContent:e.jsx(d,{icon:"lucide:folder-plus",width:18}),isDisabled:t.length===0,children:"Generate Folders"})]})]}),e.jsx(I,{className:"p-4 mb-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{className:"text-sm font-medium",children:"Switch to Stepper ID:"}),e.jsx("input",{type:"number",min:"1",className:"px-3 py-2 border rounded-md w-20",placeholder:"ID",onKeyDown:y=>{if(y.key==="Enter"){const c=parseInt(y.target.value);c>0&&f(c)}}}),e.jsx(_,{size:"sm",color:"primary",variant:"flat",onPress:()=>{const y=document.querySelector('input[type="number"]'),c=parseInt(y.value);c>0&&f(c)},children:"Switch"})]})}),e.jsx(I,{className:"p-0",children:e.jsxs(Be,{"aria-label":"Data Builder Tabs",fullWidth:!0,classNames:{tabList:"gap-0"},children:[e.jsx(q,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{icon:"lucide:layers",width:18}),e.jsx("span",{children:"Product Groups"}),e.jsx("span",{className:"text-xs bg-primary-100 text-primary-800 px-2 py-0.5 rounded-full",children:s.length})]}),children:e.jsx("div",{className:"p-6",children:e.jsx(Jt,{})})},"groups"),e.jsx(q,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{icon:"lucide:grid-3x3",width:18}),e.jsx("span",{children:"Product Ranges"}),e.jsx("span",{className:"text-xs bg-secondary-100 text-secondary-800 px-2 py-0.5 rounded-full",children:r.length})]}),children:e.jsx("div",{className:"p-6",children:e.jsx(Yt,{})})},"ranges"),e.jsx(q,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{icon:"lucide:package",width:18}),e.jsx("span",{children:"Products"}),e.jsx("span",{className:"text-xs bg-success-100 text-success-800 px-2 py-0.5 rounded-full",children:t.length})]}),children:e.jsx("div",{className:"p-6",children:e.jsx(er,{stepperID:C})})},"products"),e.jsx(q,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{icon:"lucide:link",width:18}),e.jsx("span",{children:"Relationships"})]}),children:e.jsx("div",{className:"p-6",children:e.jsx(sr,{})})},"relationships"),e.jsx(q,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{icon:"lucide:eye",width:18}),e.jsx("span",{children:"Data Preview"})]}),children:e.jsx("div",{className:"p-6",children:e.jsx(tr,{})})},"preview")]})}),e.jsx(rr,{isOpen:z,onOpenChange:D})]})};function ir(){const{productGroups:s,isLoading:r,error:t,clearError:a,initializeFromWindowData:i,loadData:n}=se();E.useEffect(()=>{window.urbanaAdmin&&s.length===0&&(console.log("App initializing from window data"),i())},[i,s.length]);const l=async()=>{try{a(),await n()}catch(o){console.error("Load failed:",o)}};return r?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx(As,{size:"lg"}),e.jsx("p",{className:"text-foreground-600",children:"Loading product data..."})]})}):e.jsx("div",{className:"min-h-screen bg-background",children:e.jsxs("div",{className:"py-6 px-4 sm:px-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Product Data Builder"}),e.jsx("p",{className:"text-foreground-500 mt-2",children:"Create and manage product configuration data"})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsx(_,{variant:"flat",color:"primary",startContent:e.jsx(d,{icon:"lucide:refresh-cw",width:18}),onPress:l,isLoading:r,children:"Refresh Data"})})]}),t&&e.jsx(bt,{color:"danger",variant:"flat",className:"mb-6",title:"Error",description:t,endContent:e.jsx(_,{variant:"light",color:"danger",size:"sm",onPress:a,children:"Dismiss"})}),e.jsx(ar,{})]})})}gt.createRoot(document.getElementById("urbana-data-builder-root")).render(e.jsx(L.StrictMode,{children:e.jsxs(ft,{children:[e.jsx(yt,{}),e.jsx("main",{className:"text-foreground bg-background",children:e.jsx(ir,{})})]})}));
